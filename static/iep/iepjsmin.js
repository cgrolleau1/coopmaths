var iep={};iep.isDev=/(\.devsesamath\.net|\.local)$/.test(window.location.hostname)||window.location.href.substr(0,7)==="file://";iep.caracteresGrecs=["alpha","beta","gamma","delta","epsilon","zeta","eta"," theta","kappa","lambda","mu","nu","xi","pi","rho","sigma","tau","phi","chi","psi","omega","Gamma","Delta","Xi","Pi","Sigma","Phi","Chi","Psi","Omega"];iep.caracteresGrecsUtf8=["α","β","γ","δ","ε","ζ","η","θ","κ","λ","μ","ν","ξ","π","ρ","σ","τ","φ","χ","ψ","ω","Γ","Δ","Ξ","Π","Σ","Φ","Χ","Ψ","Ω"];iep.log=function(){if(iep.isDev&&typeof console!=="undefined"&&console.log&&console.error){var b,a;for(b=0;b<arguments.length;b++){a=arguments[b];if(a instanceof Error){console.error(a)}else{console.log(a)}}}};iep.svgsn="http://www.w3.org/2000/svg";iep.zero=function(a){return(Math.abs(a)<1e-9)};iep.colineaires=function(b,a){var d=b.norme();var c=a.norme();if(iep.zero(d)||iep.zero(c)){return true}else{return(iep.zero((b.x*a.y-b.y*a.x)/d/c))}};iep.colineairesMemeSens=function(b,a){return iep.colineaires(b,a)&&(b.x*a.x+b.y*a.y>=0)};iep.zeroAngle=function(b){return(Math.abs(b)<1e-7)};iep.convDegRad=Math.PI/180;iep.convRadDeg=180/Math.PI;iep.cos30=Math.cos(30*iep.convDegRad);iep.sin30=0.5;iep.mesurePrincDeg=function(b){var c=Math.floor((b+180)/360);var a=b-360*c;if(a===-180){a===180}return a};iep.parseXMLDoc=function(a){if(window.DOMParser){parser=new DOMParser();xmlDoc=parser.parseFromString(a,"text/xml")}else{xmlDoc=new ActiveXObject("Microsoft.XMLDOM");xmlDoc.async=false;xmlDoc.loadXML(a)}return xmlDoc};iep.estInstrument=function(a){return a==="compas"||a==="compasLeve"||a==="crayon"||a==="equerre"||a==="rapporteur"||a==="regle"||a==="requerre"};iep.indiceFinBalise=function(d){var a,c,b;var f=false;if(d.indexOf("<font")===0){c="</font>";f=true}else{b=d.indexOf(">");if(b===-1){return d.length}a=d.substring(0,b+1);c=a.substring(0,1)+"/"+a.substring(1)}var e=d.indexOf(c);if(e===-1){if(f){var g=d.indexOf("<font",5);if(g!==-1){return g}}return -1}else{return e+c.length}};iep.analyseExposantOuIndice=function(a){var d=a.trim();var c={};var f=d.indexOf(",");var b=d.indexOf(")");c.erreur=(f===-1)||(b===-1);if(c.erreur){c.texte="";return c}var e=d.substring(3,f);var g=d.substring(f+1,b);var h=d.substring(b+1);c.operande=e;c.exposant=g;c.texte=h;return c};iep.indiceParentheseFermante=function(b,a){var e,d;var c=1;e=a+1;while(e<b.length){d=b.charAt(e);if(d==="("){c++}else{if(d===")"){c--}}if(c===0){break}e++}if(c===0){return e}else{return -1}};iep.indiceVirgule=function(c,b,a){var e,g;var d=0;var f=b;while(f<c.length){e=c.charAt(f);if(e==="("){g=iep.indiceParentheseFermante(c,f);if(g===-1){return -1}else{f=g}}else{if(e===","){d++}if(d===a){return f}}f++}return -1};iep.chiffre=function(a){var b="0123456789";return(b.indexOf(a)!==-1)};iep.valeur_approchee=function(c,a){var b=Math.pow(10,a);return Math.round(c/b)*b};iep.determiner_graduations=function(c,a,b){var d;if(a*c<0){d=-Math.floor(-c/b)*b}else{if(Math.ceil(Math.log(Math.abs(c))/Math.LN10)!==Math.ceil(Math.log(Math.abs(a))/Math.LN10)){if(c<0){d=-Math.pow(10,Math.floor(Math.log(Math.abs(c))/Math.LN10))}else{d=Math.pow(10,Math.ceil(Math.log(Math.abs(c))/Math.LN10))}d=d-Math.floor((d-c)/b)*b}else{d=iep.valeur_approchee(c,Math.floor(Math.log(b)/Math.LN10));if(d<c){d+=b}}}return d};iep.mettre_en_pixels=function(b,d,c,a,g){var f=(a-g)/(d-c);var e=a-f*d;return f*b+e};iep.elimineDoublonsXML=function(d){var f,e,m,l,k;var h="";var g=["objet","mouvement","vitesse","tempo","abscisse","ordonnee","id","couleur","pointille","echelle","angle","cible","texte","ecrire","rotation","translation","epaisseur","opacite","masquer","montrer","crayon","equerre","regle","compas","reglequerre","sens","hauteur","largeur","haut","gauche","Xmin","Ymin","Xmax","yMax","Xgrad","Ygrad","image","police","taille","ordonnee_bas_droite","abscisse_bas_droite","ordonnee_haut_gauche","abscisse_haut_gauche"];var n=d.split(/<action/gi);for(f=0;f<n.length;f++){m=n[f];for(e=0;e<g.length;e++){var c=new RegExp(" "+g[e]+'[^\\w ]*= *"[\\w]*"',"i");l=m.search(c);if(l!==-1){k=m.substring(l+1).search(c);if(k!==-1){m=m.replace(c,"")}}}h+=(f===0)?m:"<action"+m}return h};iep.infoBalise=function(e,d,f,b,c,a){this.bold=e;this.italic=d;this.underline=f;this.couleur=b;this.fontface=c;this.taille=a};iep.remplaceAccentsHtml=function(c){var d=["&agrave;","&acirc;","&aelig;","&egrave;","&eacute;","&ecirc;","&icirc;","&ocirc;","&ouml;","&oslash;","&Oslash;","&ugrave;","&ucirc;","&apos;"];var b=["à","â","æ","è","é","ê","î","ô","ö","ø","Ø","ù","û","'"];var a;for(a=0;a<d.length;a++){c=c.replace(new RegExp(d[a],"g"),b[a])}return c};iep.remplaceBalises=function(a){a=a.replace(/<B>/g,"<b>");a=a.replace(/<\/B>/g,"</b>");a=a.replace(/<I>/g,"<i>");a=a.replace(/<\/I>/g,"</i>");a=a.replace(/<U>/g,"<u>");a=a.replace(/<\/U>/g,"</u>");a=a.replace(/£lt£i£gt£/gi,"<i>");a=a.replace(/£i£/gi,"<i>");a=a.replace(new RegExp("£lt£/i£gt£","gi"),"</i>");a=a.replace(new RegExp("£/i£","gi"),"</i>");a=a.replace(/£lt£b£gt£/gi,"<b>");a=a.replace(/£b£/gi,"<b>");a=a.replace(new RegExp("£lt£/b£gt£","gi"),"</b>");a=a.replace(new RegExp("£/b£","gi"),"</b>");a=a.replace(/£lt£u£gt£/gi,"<u>");a=a.replace(/£u£/gi,"<u>");a=a.replace(new RegExp("£lt£/u£gt£","gi"),"</u>");a=a.replace(new RegExp("£/u£","gi"),"</u>");a=a.replace(/£lt£br£gt£/gi,"<br>");a=a.replace(new RegExp("£lt£br/£gt£","gi"),"<br>");a=a.replace(/£br£/gi,"<br>");a=a.replace(new RegExp("£br/£","gi"),"<br>");a=a.replace(/£lt£font/gi,"<font");a=a.replace(new RegExp("£lt£/font£gt£","gi"),"</font>");a=a.replace(/£lt£bold£gt£/gi,"<b>");a=a.replace(new RegExp("£lt£/bold£gt£","gi"),"</b>");a=a.replace(/£lt£/gi,"<");a=a.replace(/£gt£/gi,">");a=a.replace(/£inferieurstrict£/gi,"<");a=a.replace(/£superieurstrict£/gi,">");a=a.replace(/£guillemet£/gi,'"');return a};iep.remplaceCarSpe=function(h){var f,g,d,j;g=h;if(h.indexOf("£")!==-1){var e=["alpha2","plus","moins","fois","divise","petitf","petitebarre","grandebarre","prime","seconde","puceronde","grandC","euler","petitg","petith","Ironde","Lronde","lronde","grandN","Pronde","grandQ","Rronde","grandR","grandZ","Eronde","Fronde","Nronde","flecheG","flecheH","flecheD","flecheB","flecheDG","flecheGD","flecheHB","flecheBH","croissant","decroissant","alaligneadroite","alaligneagauche","doubleflecheG","doubleflecheD","doubleflecheDG","doubleflecheGD","flecheGbarre","flecheDbarre","flecheGcreuse","flecheHcreuse","flecheDcreuse","flecheBcreuse","qqsoit","pourtout","quelquesoit","complement","differentielpartiel","ilexiste","ilnexistepas","vide","nabla","appartienta","nappartientpasa","contient","petitcontient","grandproduit","grandcoproduit","grandesomme","petitebarrefine","moinsouplus","antislash","asterisque","racine","proportionnela","infini","angle","anglespherique","divise","nedivisepas","parallelea","nestpasparallelea","etlogique","oulogique","inter","intersection","union","integrale","doubleintegrale","tripleintegrale","integralecurviligne","integralesurfacique","integralevolumique","egaleasymptotiquea","environdroit","environegala","environ","egalpardefinition","differentde","identiquea","inferieura","superieura","inclusdans","contient","nestpasinclusdans","necontientpas","sommedirecte","differencedirecte","produittensoriel","divisiondirecte","produitdirect","top","perpendiculairea","antecedentde","imagede","angledroitarc","point","pv"];var c=["α","+","-","×","÷","f","–","—","'",'"',"•","ℂ","ℂ","ℊ","ℏ","ℑ","ℒ","ℓ","ℕ","℘","ℚ","ℜ","ℝ","ℤ","ℰ","ℱ","ℵ","←","↑","→","↓","↔","↔","↕","↕","↗","↘","↳","↵","⇐","⇒","⇔","⇔","⇤","⇥","⇦","⇧","⇨","⇩","∀","∀","∀","∁","∂","∃","∄","∅","∇","∈","∉","∋","∍","∏","∐","∑","−","∓","∖","∗","√","∝","∞","∡","∢","∣","∤","∥","∦","∧","∨","∩","∩","∪","∫","∬","∭","∮","∯","∰","≃","≃","≅","≈","≝","≠","≡","≤","≥","⊂","⊃","⊄","⊅","⊕","⊖","⊗","⊘","⊙","⊤","⊥","⊶","⊷","⊾","⋅",";"];for(f=0;f<e.length;f++){d="£"+e[f]+"£";j=c[f];if(g.indexOf(d)!==-1){g=g.replace(new RegExp(d,"gi"),j)}}}return g};iep.traiteBalise=function(b,m,i,a,o){var l,p,d,k,j,h,n,g,q;if(b===""){return}var f;var e=b.search(/<b>|<i>|<u>|<font/);p=document.createElementNS(iep.svgsn,"tspan");p.setAttribute("pointer-events","none");if((e===-1)||(e>0)){l="";if(m.couleur!==""){l+="fill:"+m.couleur+";"}if(m.bold){l+="font-weight:bold;"}if(m.italic){l+="font-style:italic;"}if(m.underline){l+="text-decoration:underline;"}if(m.fontface!==""){l+="fontfamily:"+m.fontface+";"}l+="font-size:"+m.taille+";";p.setAttribute("style",l);if(a){p.setAttribute("x",0);a=false}p.setAttribute("y",o);var c=(e===-1)?b:b.substring(0,e);p.appendChild(document.createTextNode(c));i.appendChild(p);if(e>0){iep.traiteBalise(b.substring(e),m,i,a,o)}else{b=""}}else{if(b.indexOf("<b>")===0){f=new iep.infoBalise(true,m.italic,m.underline,m.couleur,m.fontface);d=iep.indiceFinBalise(b);if(d===-1){iep.traiteBalise(b.substring(3),f,i,a,o)}else{iep.traiteBalise(b.substring(3,d-4),f,i,a,o)}}else{if(b.indexOf("<i>")===0){f=new iep.infoBalise(m.bold,true,m.underline,m.couleur,m.fontface);d=iep.indiceFinBalise(b);if(d===-1){iep.traiteBalise(b.substring(3),f,i,a,o)}else{iep.traiteBalise(b.substring(3,d-4),f,i,a,o)}}else{if(b.indexOf("<u>")===0){f=new iep.infoBalise(m.bold,m.italic,true,m.couleur,m.fontface);d=iep.indiceFinBalise(b);if(d===-1){iep.traiteBalise(b.substring(3),f,i,a,o)}else{iep.traiteBalise(b.substring(3,d-4),f,i,a,o)}}else{if(b.indexOf("<font")===0){d=iep.indiceFinBalise(b);if(d===-1){d=b.length}k=b.indexOf('face="');if(k!==-1){j=b.indexOf('"',k+6);if(j!==-1){h=b.substring(k+6,j)}else{h=""}}else{h=""}k=b.indexOf('couleur="');if(k!==-1){j=b.indexOf('"',k+9);if(j!==-1){n=iep.couleur(b.substring(k+9,j))}}else{k=b.indexOf('color="');if(k!==-1){j=b.indexOf('"',k+7);if(j!==-1){n=iep.couleur(b.substring(k+7,j))}}}k=b.indexOf('size="');if(k!==-1){j=b.indexOf('"',k+6);if(j!==-1){g=b.substring(k+6,j)}else{g=m.taille}}f=new iep.infoBalise(m.bold,m.italic,m.underline,n,h,g);q=b.indexOf(">");if(b.search(new RegExp("</font>","i"))!==-1){iep.traiteBalise(b.substring(q+1,d-7),f,i,a,o)}else{iep.traiteBalise(b.substring(q+1),f,i,a,o)}}}}}}};iep.necessiteLatex=function(f){var d,g,b,e,c;var a="acdfgnprsuv";for(d=0;d<a.length;d++){if(f.indexOf("£"+a.charAt(d)+"(")!==-1){return true}}c=f;while((g=c.search(/£e\(|£i\(/g))!==-1){b=iep.indiceParentheseFermante(c,g+3);if(b===-1){b=c.length}e=c.substring(g,b);if(e.search(/£e\(|£i\(\£lt\£font/g)!==-1){return true}if(b===c.length){return false}else{c=e.substring(b+1)}}c=f;while((g=c.search(/\£lt\£font/g))!==-1){b=iep.indiceFinBalise(c.substring(g));if(b===-1){b=c.length}else{b+=g}e=c.substring(g,b);if(e.search(/£e\(|£i\(/g)!==-1){return true}if(b===c.length){return false}else{c=e.substring(b+1)}}return false};iep.getMaths=function(o,p){var c,d,g,h,e,n,b,l,f,k,j,i,m;var a=o;if(a===""){return""}while((c=a.indexOf("<font"))!==-1){l=null;b=a.substring(c);d=iep.indiceFinBalise(b);h=b.indexOf('couleur="');if(h!==-1){e=b.indexOf('"',h+9);if(e!==-1){l=iep.couleur(b.substring(h+9,e))}}else{h=b.indexOf('color="');if(h!==-1){e=b.indexOf('"',h+7);if(e!==-1){l=iep.couleur(b.substring(h+7,e))}}}if(l!=null){n=c+b.indexOf(">")+1;if(d===-1){return iep.getMaths(a.substring(0,c)+"\\textcolor{"+l+"}{"+a.substring(n)+"}",p)}else{d+=c;return iep.getMaths(a.substring(0,c)+"\\textcolor{"+l+"}{"+a.substring(n,d-7)+"}"+a.substring(d),p)}}else{n=c+b.indexOf(">")+1;if(d===-1){return iep.getMaths(a.substring(0,c)+a.substring(n),p)}else{d+=c;return iep.getMaths(a.substring(0,c)+a.substring(n,d-7)+a.substring(d),p)}}}while((c=a.indexOf("£u("))!==-1){d=iep.indiceParentheseFermante(a,c+2);if(d===-1){return a}return iep.getMaths(a.substring(0,c),p)+"\\unicode{x"+a.substring(c+3,d)+"}"+iep.getMaths(a.substring(d+1),p)}while((c=a.indexOf("£f("))!==-1){g=iep.indiceVirgule(a,c+3,1);d=iep.indiceParentheseFermante(a,c+2);if((g===-1)||(d===-1)||(g>d)){return a}return iep.getMaths(iep.getMaths(a.substring(0,c),p)+"\\frac{"+iep.getMaths(a.substring(c+3,g),false)+"}{"+iep.getMaths(a.substring(g+1,d),false)+"}"+iep.getMaths(a.substring(d+1),p),p)}while((c=a.indexOf("£r("))!==-1){d=iep.indiceParentheseFermante(a,c+2);if(d===-1){return a}return iep.getMaths(iep.getMaths(a.substring(0,c),p)+"\\sqrt{"+iep.getMaths(a.substring(c+3,d),false)+"}"+iep.getMaths(a.substring(d+1),p),p)}while((c=a.indexOf("£a("))!==-1){d=iep.indiceParentheseFermante(a,c+2);if(d===-1){return a}return iep.getMaths(iep.getMaths(a.substring(0,c),p)+"\\widehat{"+iep.getMaths(a.substring(c+3,d),true)+"}"+iep.getMaths(a.substring(d+1),p),p)}while((c=a.indexOf("£g("))!==-1){k=iep.indiceVirgule(a,c+3,1);j=iep.indiceVirgule(a,c+3,2);i=iep.indiceVirgule(a,c+3,3);d=iep.indiceParentheseFermante(a,c+2);if(d===-1){return a}return iep.getMaths(iep.getMaths(a.substring(0,c),p)+"\\int_{"+iep.getMaths(a.substring(j+1,i),false)+"}^{"+iep.getMaths(a.substring(i+1,d),false)+"}"+iep.getMaths(a.substring(c+3,k),false)+" d"+iep.getMaths(a.substring(k+1,j),false)+iep.getMaths(a.substring(d+1),p),p)}while((c=a.indexOf("£c("))!==-1){d=iep.indiceParentheseFermante(a,c+2);if(d===-1){return a}return iep.getMaths(a.substring(0,c),p)+"\\left["+iep.getMaths(a.substring(c+3,d),p)+"\\right]"+iep.getMaths(a.substring(d+1),p)}while((c=a.indexOf("£p("))!==-1){d=iep.indiceParentheseFermante(a,c+2);if(d===-1){return a}return iep.getMaths(iep.getMaths(a.substring(0,c),p)+"\\left("+iep.getMaths(a.substring(c+3,d),p)+"\\right)"+iep.getMaths(a.substring(d+1),p))}while((c=a.indexOf("£d("))!==-1){d=iep.indiceParentheseFermante(a,c+2);if(d===-1){return a}return iep.getMaths(iep.getMaths(a.substring(0,c),p)+"\\left|"+iep.getMaths(a.substring(c+3,d),false)+"\\right|"+iep.getMaths(a.substring(d+1),p),p)}while((c=a.indexOf("£n("))!==-1){d=iep.indiceParentheseFermante(a,c+2);if(d===-1){return a}return iep.getMaths(iep.getMaths(a.substring(0,c),p)+"\\left\\|"+iep.getMaths(a.substring(c+3,d),false)+"\\right\\|"+iep.getMaths(a.substring(d+1),p))}while((c=a.indexOf("£i("))!==-1){g=iep.indiceVirgule(a,c+3,1);d=iep.indiceParentheseFermante(a,c+2);if((g===-1)||(d===-1)||(g>d)){return a}return iep.getMaths(iep.getMaths(a.substring(0,c),p)+"{"+iep.getMaths(a.substring(c+3,g),false)+"}_{"+iep.getMaths(a.substring(g+1,d),false)+"}"+iep.getMaths(a.substring(d+1),p),p)}while((c=a.indexOf("£e("))!==-1){g=iep.indiceVirgule(a,c+3,1);d=iep.indiceParentheseFermante(a,c+2);if((g===-1)||(d===-1)||(g>d)){return a}return iep.getMaths(iep.getMaths(a.substring(0,c),p)+"{"+iep.getMaths(a.substring(c+3,g),false)+"}^{"+iep.getMaths(a.substring(g+1,d),false)+"}"+iep.getMaths(a.substring(d+1),p))}while((c=a.indexOf("£v("))!==-1){d=iep.indiceParentheseFermante(a,c+2);if(d===-1){return a}return iep.getMaths(iep.getMaths(a.substring(0,c),p)+"\\overrightarrow{"+iep.getMaths(a.substring(c+3,d),false)+"}"+iep.getMaths(a.substring(d+1),p),p)}while((c=a.indexOf("<u>"))!==-1){d=iep.indiceFinBalise(a.substring(c));if(d===-1){return a}else{d+=c}return iep.getMaths(a.substring(0,c),p)+"\\underline{"+iep.getMaths(a.substring(c+3,d-4),true)+"}"+iep.getMaths(a.substring(d),p)}while((c=a.indexOf("<i>"))!==-1){d=iep.indiceFinBalise(a.substring(c));if(d===-1){return iep.getMaths(a.substring(0,c),p)+"\\textit{"+iep.getMaths(a.substring(c+3),false)+"}"}else{d+=c;return iep.getMaths(a.substring(0,c),p)+"\\textit{"+iep.getMaths(a.substring(c+3,d-4),false)+"}"+iep.getMaths(a.substring(d),p)}}while((c=a.indexOf("<b>"))!==-1){d=iep.indiceFinBalise(a.substring(c));if(d===-1){return iep.getMaths(a.substring(0,c),p)+"\\textbf{"+iep.getMaths(a.substring(c+3),false)+"}"}else{d+=c;return iep.getMaths(a.substring(0,c),p)+"\\textbf{"+iep.getMaths(a.substring(c+3,d-4),false)+"}"+iep.getMaths(a.substring(d),p)}}if(p){if(iep.contientBaliseLaTeX(a)){return a}else{c=a.indexOf("\\textcolor{");if(c!==-1){f="";b=a;while((c=b.indexOf("\\textcolor{"))!=-1){h=b.indexOf("}{");d=iep.accoladeFermante(b,h+1);if(d===-1){if(c==0){if(h+2!=b.length){f+=b.substring(0,h+2)+"\\text{"+b.substring(h+2)+"}"}else{f+=b}b=""}else{if(h+2!=b.length){f+="\\text{"+b.substring(0,c)+"}"+b.substring(c,h+2)+"\\text{"+b.substring(h+2)+"}"}else{f+="\\text{"+b.substring(0,c)+"}"+b.substring(c,h+2)}b=""}}else{if(c==0){f+=b.substring(0,d+1);if(d<b.length-1){b=b.substring(d+1)}else{b=""}}else{f+="\\text{"+b.substring(0,c)+"}"+b.substring(c,h+2)+"\\text{"+b.substring(h+2,d+1)+"}";if(d<b.length-1){b=b.substring(d+1)}else{b=""}}}}if(b===""){return f}else{return f+"\\text{"+b+"}"}}else{m=a.charAt(0);if((m===")")||(m===",")||(m==="}")){return a}else{return"\\text{"+a+"}"}}}}else{return a}};iep.getMathsForName=function(o,p){var c,d,g,h,e,n,b,l,f,k,j,i,m;var a=o;if(a===""){return""}while((c=a.indexOf("<font"))!==-1){l=null;b=a.substring(c);d=iep.indiceFinBalise(b);h=b.indexOf('couleur="');if(h!==-1){e=b.indexOf('"',h+9);if(e!==-1){l=iep.couleur(b.substring(h+9,e))}}else{h=b.indexOf('color="');if(h!==-1){e=b.indexOf('"',h+7);if(e!==-1){l=iep.couleur(b.substring(h+7,e))}}}if(l!==null){n=c+b.indexOf(">")+1;if(d===-1){return iep.getMathsForName(a.substring(0,c)+"\\textcolor{"+l+"}{"+a.substring(n)+"}",p)}else{d+=c;return iep.getMathsForName(a.substring(0,c)+"\\textcolor{"+l+"}{"+a.substring(n,d-7)+"}"+a.substring(d),p)}}else{n=c+b.indexOf(">")+1;if(d===-1){return iep.getMathsForName(a.substring(0,c)+a.substring(n),p)}else{d+=c;return iep.getMathsForName(a.substring(0,c)+a.substring(n,d-7)+a.substring(d),p)}}}while((c=a.indexOf("£u("))!==-1){d=iep.indiceParentheseFermante(a,c+2);if(d===-1){return a}return iep.getMathsForName(a.substring(0,c),p)+"\\unicode{x"+a.substring(c+3,d)+"}"+iep.getMathsForName(a.substring(d+1),p)}while((c=a.indexOf("£r("))!==-1){d=iep.indiceParentheseFermante(a,c+2);if(d===-1){return a}return iep.getMathsForName(iep.getMathsForName(a.substring(0,c),p)+"\\sqrt{"+iep.getMathsForName(a.substring(c+3,d),false)+"}"+iep.getMathsForName(a.substring(d+1),p),p)}while((c=a.indexOf("£d("))!==-1){d=iep.indiceParentheseFermante(a,c+2);if(d===-1){return a}return iep.getMathsForName(iep.getMathsForName(a.substring(0,c),p)+"\\left|"+iep.getMathsForName(a.substring(c+3,d),false)+"\\right|"+iep.getMathsForName(a.substring(d+1),p),p)}while((c=a.indexOf("£n("))!==-1){d=iep.indiceParentheseFermante(a,c+2);if(d===-1){return a}return iep.getMathsForName(iep.getMathsForName(a.substring(0,c),p)+"\\left\\|"+iep.getMathsForName(a.substring(c+3,d),false)+"\\right\\|"+iep.getMathsForName(a.substring(d+1),p))}while((c=a.indexOf("£i("))!==-1){g=iep.indiceVirgule(a,c+3,1);d=iep.indiceParentheseFermante(a,c+2);if((g===-1)||(d===-1)||(g>d)){return a}return iep.getMathsForName(iep.getMathsForName(a.substring(0,c),p)+"{"+iep.getMathsForName(a.substring(c+3,g),true)+"}_{"+iep.getMathsForName(a.substring(g+1,d),false)+"}"+iep.getMathsForName(a.substring(d+1),p),p)}while((c=a.indexOf("£e("))!==-1){g=iep.indiceVirgule(a,c+3,1);d=iep.indiceParentheseFermante(a,c+2);if((g===-1)||(d===-1)||(g>d)){return a}return iep.getMathsForName(iep.getMathsForName(a.substring(0,c),p)+"{"+iep.getMathsForName(a.substring(c+3,g),true)+"}^{"+iep.getMathsForName(a.substring(g+1,d),false)+"}"+iep.getMathsForName(a.substring(d+1),p))}while((c=a.indexOf("£v("))!==-1){d=iep.indiceParentheseFermante(a,c+2);if(d===-1){return a}return iep.getMathsForName(iep.getMathsForName(a.substring(0,c),p)+"\\overrightarrow{"+iep.getMathsForName(a.substring(c+3,d),false)+"}"+iep.getMathsForName(a.substring(d+1),p),p)}while((c=a.indexOf("<u>"))!==-1){d=iep.indiceFinBalise(a.substring(c));if(d===-1){return a}else{d+=c}return iep.getMathsForName(a.substring(0,c),p)+"\\underline{"+iep.getMathsForName(a.substring(c+3,d-4),true)+"}"+iep.getMathsForName(a.substring(d),p)}while((c=a.indexOf("<i>"))!==-1){d=iep.indiceFinBalise(a.substring(c));if(d===-1){return iep.getMathsForName(a.substring(0,c),p)+"\\textit{"+iep.getMathsForName(a.substring(c+3),false)+"}"}else{d+=c;return iep.getMathsForName(a.substring(0,c),p)+"\\textit{"+iep.getMathsForName(a.substring(c+3,d-4),false)+"}"+iep.getMathsForName(a.substring(d),p)}}while((c=a.indexOf("<b>"))!==-1){d=iep.indiceFinBalise(a.substring(c));if(d===-1){return iep.getMathsForName(a.substring(0,c),p)+"\\textbf{"+iep.getMathsForName(a.substring(c+3),false)+"}"}else{d+=c;return iep.getMathsForName(a.substring(0,c),p)+"\\textbf{"+iep.getMathsForName(a.substring(c+3,d-4),false)+"}"+iep.getMathsForName(a.substring(d),p)}}if(p){if(iep.contientBaliseLaTeX(a)){return a}else{c=a.indexOf("\\textcolor{");if(c!==-1){f="";b=a;while((c=b.indexOf("\\textcolor{"))!=-1){h=b.indexOf("}{");d=iep.accoladeFermante(b,h+1);if(d===-1){if(c==0){if(h+2!=b.length){f+=b.substring(0,h+2)+"\\text{"+b.substring(h+2)+"}"}else{f+=b}b=""}else{if(h+2!=b.length){f+="\\text{"+b.substring(0,c)+"}"+b.substring(c,h+2)+"\\text{"+b.substring(h+2)+"}"}else{f+="\\text{"+b.substring(0,c)+"}"+b.substring(c,h+2)}b=""}}else{if(c==0){f+=b.substring(0,d+1);if(d<b.length-1){b=b.substring(d+1)}else{b=""}}else{f+="\\text{"+b.substring(0,c)+"}"+b.substring(c,h+2)+"\\text{"+b.substring(h+2,d+1)+"}";if(d<b.length-1){b=b.substring(d+1)}else{b=""}}}}if(b===""){return f}else{return f+"\\text{"+b+"}"}}else{m=a.charAt(0);if((m===")")||(m===",")||(m==="}")){return a}else{return"\\text{"+a+"}"}}}}else{return a}};iep.iepApp=function(){this.docs=[];var a=this;window.addEventListener("unload",function(){a.closeAllXMLWindows()})};iep.iepApp.prototype.addDoc=function(b,a,c){var d;if(typeof b==="string"){b=document.getElementById(b)}if(!b){return new Error("svg manquant")}if(b.localName!="svg"){return new Error("svg incorrect")}d=new iep.iepDoc(b,a,(arguments.length<=2)?true:c);this.docs.push(d);b.iepDoc=d;return d};iep.iepApp.prototype.closeAllXMLWindows=function(){var a;for(a=0;a<this.docs.length;a++){var b=this.docs[a];if(b.windowxml!=null){b.windowxml.close()}}};var iep;if(!iep){iep={}}iep.iepDoc=function(b,e,c){this.svg=b;this.autoStart=c;this.windowxml=null;var f=e;if(f.search(/<?xml/gi)==-1){f='<?xml version="1.0" encoding="UTF-8"?>'+f}f=f.replace(/<action[_]\d*/gi,"<action");f=f.replace(/<!--.*-->/g,"");f=f.replace(/(="[^"]*")([^ ])/g,"$1 $2").replace(/--/g,"");f=f.replace(/<</g,"<").replace(/>>/g,">");f=f.replace(/<action(\w)/gi,"<action $1");f=iep.elimineDoublonsXML(f);this.codexml=f;var a=f.search(/<\s*INSTRUMENPOCHE/gi);var h=f.indexOf(">",a);var g=f.search(new RegExp("<s*/INSTRUMENPOCHE","gi"));this.chdoc="<INSTRUMENPOCHE>"+f.substring(h+1,g)+"</INSTRUMENPOCHE>";this.actions=[];this.elements=[];this.compasRetourne=false;this.compasLeve=null;this.compas=new iep.compas(this);this.equerre=new iep.equerre(this);this.rapporteur=new iep.rapporteur(this);this.regle=new iep.regle(this);this.requerre=new iep.requerre(this);this.crayon=new iep.crayon(this);this.xmldoc=iep.parseXMLDoc(this.chdoc);this.tabact=this.xmldoc.getElementsByTagName("action");this.started=false;this.animationEnCours=true;this.indiceActionEnCours=0;this.creeActions();var d=this;b.addEventListener("mousemove",function(i){d.onmousemove(i,i.clientX,i.clientY)},false);b.addEventListener("mouseup",function(){d.onmouseup()},false);b.addEventListener("mouseleave",function(){d.onmouseleave()},false);b.addEventListener("touchmove",function(i){d.onmousemove(i,i.touches[0].pageX,i.touches[0].pageY)},false);b.addEventListener("touchend",function(){d.onmouseup()},false);b.addEventListener("touchcancel",function(){d.onmouseup()},false);b.addEventListener("touchleave",function(){d.onmouseleave()},false);iep.log("iepDoc instancié : ",this)};iep.iepDoc.prototype.waitForReadyState=function(){if(this.started){return}var b=this.verifyReadyState();if(b){this.start()}else{var a=this;setTimeout(function(){if(!a.started){alert("Le chargement de la figure IEP a échoué");a.started=true}},10000)}};iep.iepDoc.prototype.verifyReadyState=function(){var b=true;var a;for(a=0;a<this.actions.length;a++){b=b&&this.actions[a].isReady}return b};iep.iepDoc.prototype.creeElementsGraphiques=function(){var a;for(a=0;a<this.actions.length;a++){this.actions[a].creegElement()}};iep.iepDoc.prototype.initialiseOutils=function(){this.compas.initialisePosition();this.equerre.initialisePosition();this.rapporteur.initialisePosition();this.regle.initialisePosition();this.requerre.initialisePosition();this.crayon.initialisePosition();this.compas.montre(false);this.compas.leve=false;this.equerre.montre(false);this.rapporteur.montre(false);this.regle.montre(false);this.requerre.montre(false);this.crayon.montre(false)};iep.iepDoc.prototype.recreeOutils=function(){this.compas.updateg();this.equerre.updateg();this.rapporteur.updateg();this.regle.updateg();this.requerre.updateg();this.crayon.updateg();this.compas.montre(false);this.compas.leve=false;this.equerre.montre(false);this.rapporteur.montre(false);this.regle.montre(false);this.requerre.montre(false);this.crayon.montre(false)};iep.iepDoc.prototype.start=function(){this.started=true;this.creeElementsGraphiques();this.recreeOutils();this.creeIcones();this.InitialiseIcones();if(this.autoStart){this.onPlay()}else{this.montreIcone("Pause",false);this.montreIcone("Play",true)}};iep.iepDoc.prototype.creeIcones=function(){var b=8;var a=this;this.barreIcones=document.createElementNS(iep.svgsn,"g");this.creeElementsPourIcones();this.iconeGoBegin=new iep.iconeGoBegin(0,0,"fonce");this.iconeGoBeginGris=new iep.iconeGoBegin(0,0,"clair");this.iconeGoBegin.onclick=function(){a.onGoBegin()};this.barreIcones.appendChild(this.iconeGoBegin);this.barreIcones.appendChild(this.iconeGoBeginGris);this.iconeStepPrev=new iep.iconeStepPrev(32,0,"fonce");this.iconeStepPrevGris=new iep.iconeStepPrev(32,0,"clair");this.iconeStepPrev.onclick=function(){a.onStepPrev()};this.barreIcones.appendChild(this.iconeStepPrev);this.barreIcones.appendChild(this.iconeStepPrevGris);this.iconePause=iep.iconePause(64,0,"fonce");this.iconePauseGris=iep.iconePause(64,0,"clair");this.iconePause.onclick=function(){a.onPause()};this.barreIcones.appendChild(this.iconePause);this.barreIcones.appendChild(this.iconePauseGris);this.iconePlay=new iep.iconePlay(96,0,"fonce");this.iconePlayGris=new iep.iconePlay(96,0,"clair");this.iconePlay.onclick=function(){a.onPlay()};this.barreIcones.appendChild(this.iconePlay);this.iconePlay2=new iep.iconePlay(96,0,"rouge");this.iconePlay2.setAttribute("visibility","hidden");this.iconePlay2.onclick=function(){a.onPlayContinuer()};this.barreIcones.appendChild(this.iconePlay2);this.barreIcones.appendChild(this.iconePlayGris);this.iconeRestart=new iep.iconeRestart(128,0,"fonce");this.iconeRestartGris=new iep.iconeRestart(128,0,"clair");this.iconeRestart.onclick=function(){a.onRestart()};this.barreIcones.appendChild(this.iconeRestart);this.barreIcones.appendChild(this.iconeRestartGris);this.iconeStepNext=new iep.iconeStepNext(160,0,"fonce");this.iconeStepNextGris=new iep.iconeStepNext(160,0,"clair");this.iconeStepNext.onclick=function(){a.onStepNext()};this.barreIcones.appendChild(this.iconeStepNext);this.barreIcones.appendChild(this.iconeStepNextGris);this.iconeGoEnd=new iep.iconeGoEnd(192,0,"fonce");this.iconeGoEndGris=new iep.iconeGoEnd(192,0,"clair");this.iconeGoEnd.onclick=function(){a.onGoEnd()};this.barreIcones.appendChild(this.iconeGoEnd);this.barreIcones.appendChild(this.iconeGoEndGris);this.iconeXML=new iep.iconeXML(224,0,"fonce");this.iconeXMLGris=new iep.iconeXML(224,0,"clair");this.iconeXML.onclick=function(){a.onXML()};this.barreIcones.appendChild(this.iconeXML);this.barreIcones.appendChild(this.iconeXMLGris);this.hauteurBarre=32;this.demiLargeurBarre=b*16;this.xbarre=50;this.ybarre=4;this.barreIcones.setAttribute("transform","translate("+this.xbarre+",4)");this.svg.appendChild(this.barreIcones);this.isDraggingBarre=false;var a=this;this.barreIcones.addEventListener("mousedown",function(c){a.onmousedownbarre(c.clientX,c.clientY)},false);this.barreIcones.addEventListener("mousemove",function(c){a.onmousemovebarre(c.clientX,c.clientY)},false);this.barreIcones.addEventListener("touchstart",function(c){a.onmousedownbarre(c.touches[0].pageX,c.touches[0].pageY)},false);this.barreIcones.addEventListener("touchmove",function(){a.onmousemovebarre()},false);this.deltax=0;this.deltay=0};iep.iepDoc.prototype.onmousedownbarre=function(b,a){if(this.animationEnCours){return}this.isDraggingBarre=true;this.xcapturebarre=b;this.ycapturebarre=a};iep.iepDoc.prototype.onmousemovebarre=function(){if(this.animationEnCours){this.barreIcones.style.cursor="default";this.isDraggingBarre=false;return}this.barreIcones.style.cursor="pointer"};iep.iepDoc.prototype.onmousemove=function(i,d,g){if(this.isDraggingBarre){var j=parseInt(this.svg.getAttribute("width"));var f=parseInt(this.svg.getAttribute("height"));var l=d-this.xcapturebarre;var k=g-this.ycapturebarre;var c=this.deltax+l;var b=this.deltay+k;var e=this.xbarre+c;var a=this.ybarre+b;if((e<=j-2*this.demiLargeurBarre)&&(e>=0)&&(a>=0)&&(a<=f-this.hauteurBarre)){this.barreIcones.setAttribute("transform","translate("+e+","+a+")");this.deltax=c;this.deltay=b;this.xcapturebarre=d;this.ycapturebarre=g}i.preventDefault()}};iep.iepDoc.prototype.onmouseup=function(){this.isDraggingBarre=false};iep.iepDoc.prototype.onmouseleave=function(){this.isDraggingBarre=false};iep.iepDoc.prototype.onXML=function(){if(this.windowxml==null){this.windowxml=this.popup()}else{this.windowxml.focus()}};iep.iepDoc.prototype.montreIcone=function(b,c){var a="icone"+b;this[a].setAttribute("visibility",c?"visible":"hidden");this[a+"Gris"].setAttribute("visibility",c?"hidden":"visible")};iep.iepDoc.prototype.activeIconeContinuer=function(){this.montreIcone("GoBegin",false);this.montreIcone("StepPrev",false);this.montreIcone("Pause",false);this.montreIcone("Play",false);this.montreIcone("Restart",false);this.montreIcone("StepNext",false);this.montreIcone("GoEnd",false);this.iconePlayGris.setAttribute("visibility","hidden");this.iconePlay2.setAttribute("visibility","visible");this.montreIcone("XML",true)};iep.iepDoc.prototype.InitialiseIcones=function(){this.montreIcone("GoBegin",false);this.montreIcone("StepPrev",false);this.montreIcone("Pause",true);this.montreIcone("Play",false);this.montreIcone("Restart",false);this.montreIcone("StepNext",false);this.montreIcone("GoEnd",false);this.montreIcone("XML",false)};iep.iepDoc.prototype.onGoBegin=function(){this.animationEnCours=false;this.initialise();this.montreIcone("GoBegin",false);this.montreIcone("StepPrev",false);this.montreIcone("Pause",false);this.montreIcone("Play",true);this.montreIcone("Restart",false);this.montreIcone("StepNext",true);this.montreIcone("GoEnd",true);this.montreIcone("XML",true);this.indiceActionEnCours=0};iep.iepDoc.prototype.onGoEnd=function(){this.animationEnCours=false;this.initialise();this.montreIcone("GoBegin",true);this.montreIcone("StepPrev",true);this.montreIcone("Pause",false);this.montreIcone("Play",false);this.montreIcone("Restart",true);this.montreIcone("StepNext",false);this.montreIcone("GoEnd",false);this.montreIcone("XML",true);this.indiceActionEnCours=this.actions.length;this.executeJusque(this.actions.length-1)};iep.iepDoc.prototype.onPlay=function(){this.animationEnCours=true;this.montreIcone("GoBegin",false);this.montreIcone("StepPrev",false);this.montreIcone("Pause",true);this.montreIcone("Play",false);this.montreIcone("Restart",false);this.montreIcone("StepNext",false);this.montreIcone("GoEnd",false);this.montreIcone("XML",false);this.actions[this.indiceActionEnCours].execute(false)};iep.iepDoc.prototype.onPlayContinuer=function(){if(this.indiceActionEnCours===this.actions.length){this.onGoEnd();return}this.iconePlay2.setAttribute("visibility","hidden");this.montreIcone("GoBegin",false);this.montreIcone("StepPrev",false);this.montreIcone("Pause",true);this.montreIcone("Play",false);this.montreIcone("Restart",false);this.montreIcone("StepNext",false);this.montreIcone("GoEnd",false);this.montreIcone("XML",false);this.animationEnCours=true;this.indiceActionEnCours++;this.actions[this.indiceActionEnCours].execute(false)};iep.iepDoc.prototype.onRestart=function(){var a=this;if(this.animationEnCours){this.animationEnCours=false;setTimeout(function(){a.onRestart()},100);return}if(this.animationEnCours){return}this.animationEnCours=false;this.initialise();this.indiceActionEnCours=0;this.onPlay()};iep.iepDoc.prototype.onPause=function(){var a=this;a.animationEnCours=false;setTimeout(function(){a.montreIcone("GoBegin",true);a.montreIcone("StepPrev",true);a.montreIcone("Pause",false);a.montreIcone("Play",true);a.montreIcone("Restart",true);a.montreIcone("StepNext",true);a.montreIcone("GoEnd",true);a.montreIcone("XML",true)},500)};iep.iepDoc.prototype.onStepNext=function(){this.animationEnCours=false;if(this.actions[this.indiceActionEnCours].actionVisible()){this.indiceActionEnCours++}else{this.indiceActionEnCours=this.indiceProchaineActionVisible(this.indiceActionEnCours)+1}this.executeJusque(this.indiceActionEnCours-1);var a=this.indiceActionEnCours===this.actions.length;this.montreIcone("GoBegin",true);this.montreIcone("StepPrev",true);this.montreIcone("Pause",false);this.montreIcone("Play",a?false:true);this.montreIcone("Restart",true);this.montreIcone("StepNext",a?false:true);this.montreIcone("GoEnd",a?false:true);this.montreIcone("XML",true)};iep.iepDoc.prototype.onStepPrev=function(){this.animationEnCours=false;this.indiceActionEnCours=this.indicePrecedenteActionVisible(this.indiceActionEnCours-1);if(this.indiceActionEnCours>0){this.executeJusque(this.indiceActionEnCours-1)}var a=this.indiceActionEnCours===0;this.montreIcone("GoBegin",a?false:true);this.montreIcone("StepPrev",a?false:true);this.montreIcone("Pause",false);this.montreIcone("Play",true);this.montreIcone("Restart",false);this.montreIcone("StepNext",true);this.montreIcone("GoEnd",true);this.montreIcone("XML",true)};iep.iepDoc.prototype.initialise=function(){var b;var a=this.svg;for(b=0;b<a.children.length;b++){var c=a.children[b];if(c!=this.barreIcones){a.children[b].setAttribute("visibility","hidden")}}for(b=0;b<this.actions.length;b++){var d=this.actions[b];if(d instanceof iep.actionCreation){d.objet.initialisePosition()}}this.initialiseOutils()};iep.iepDoc.prototype.getInstrumentVisibility=function(c,a){if(a===-1){return false}var d;var e=false;for(var b=0;b<=a;b++){d=this.actions[b];if(d instanceof iep.actionMontrerInstrument){if(d.instrument===c){e=true}}else{if(d instanceof iep.actionMasquerInstrument){if(d.instrument===c){e=false}}}}return e};iep.iepDoc.prototype.getObjectVisibility=function(b,a){if(a===-1){return false}var d;var e=false;for(var c=0;c<=a;c++){d=this.actions[c];if(d instanceof iep.actionMontrer){if(d.objet===b){e=true}}else{if(d instanceof iep.actionMasquer){if(d.objet===b){e=false}}}}return e};iep.iepDoc.prototype.getCompasStatus=function(a){if(a===-1){return"couche"}var c=true;var d;for(var b=0;b<=a;b++){d=this.actions[b];if(d instanceof iep.actionCoucherCompas){c=true}else{if(d instanceof iep.actionLeverCompas){c=false}}}return c?"couche":"leve"};iep.iepDoc.prototype.indiceProchaineActionVisible=function(b){var a;if(b>=this.actions.lentgh){return this.actions.length}for(a=b;a<this.actions.length;a++){if(this.actions[a].actionVisible()){return a}}return this.actions.length};iep.iepDoc.prototype.indicePrecedenteActionVisible=function(b){var a;if(b<0){return 0}for(a=b;a>=0;a--){if(this.actions[a].actionVisible()){return a}}return 0};iep.iepDoc.prototype.montreInstrumentsEtape=function(b){var a;a=this.getInstrumentVisibility(this.compas,b);if(this.compas.leve){this.compasLeve.montre(a)}else{this.compas.montre(a)}a=this.getInstrumentVisibility(this.crayon,b);this.crayon.montre(a);a=this.getInstrumentVisibility(this.equerre,b);this.equerre.montre(a);a=this.getInstrumentVisibility(this.rapporteur,b);this.rapporteur.montre(a);a=this.getInstrumentVisibility(this.regle,b);this.regle.montre(a);a=this.getInstrumentVisibility(this.requerre,b);this.requerre.montre(a)};iep.iepDoc.prototype.executeJusque=function(a){if(a>=this.actions.length){return}this.initialise();this.initialiseOutils();this.animationEnCours=false;for(var b=0;b<=a;b++){this.actions[b].execute(true)}this.montreInstrumentsEtape(a)};iep.iepDoc.prototype.addElement=function(b){var a,c;for(a=0;a<this.elements.length;a++){c=this.elements[a];if((c.id===b.id)&&(c.objet===b.objet)){this.elements[a]=b;return}}this.elements.push(b)};iep.iepDoc.prototype.pushElement=function(a){this.elements.push(a)};iep.iepDoc.prototype.getElement=function(d,b){var a,c;for(a=0;a<this.elements.length;a++){c=this.elements[a];if((c.id===d)&&(c.objet===b)){return c}}return null};iep.iepDoc.prototype.setElement=function(c,b){var a;for(a=0;a<this.elements.length;a++){if(this.elements[a].id===c){this.elements[a]=b;return true}}return false};iep.iepDoc.prototype.ajouteAction=function(a){a.indice=this.actions.length;this.actions.push(a)};iep.iepDoc.prototype.creeActions=function(){var l,c,p,z,s,x,n,a,m,r,A,D,C,q,d,i,w,u,y,b,t,h,v;for(l=0;l<this.tabact.length;l++){c=this.tabact[l];r=iep.getId(c);p=c.getAttribute("mouvement");u=c.getAttribute("tempo");try{switch(p){case"creer":z=c.getAttribute("objet");if(z!=null){switch(z){case"point":s=new iep.point(this,r,parseFloat(iep.getAbs(c)),parseFloat(iep.getOrd(c)),iep.getCouleur(c),iep.getEpaisseur(c));x=new iep.actionCreation(this,r,s,u);break;case"angle":s=new iep.angle(this,r,iep.getAbs(c),iep.getOrd(c),c.getAttribute("rayon"),c.getAttribute("angle1"),c.getAttribute("angle2"),iep.getCouleur(c),iep.getEpaisseur(c),iep.getOpaciteFond(c),c.getAttribute("forme"));x=new iep.actionCreation(this,r,s,u);break;case"angle_droit":s=new iep.angleDroit(this,r,c.getAttribute("abscisse_sommet"),c.getAttribute("ordonnee_sommet"),c.getAttribute("abscisse_inter"),c.getAttribute("ordonnee_inter"),iep.getCouleur(c),iep.getEpaisseur(c));x=new iep.actionCreation(this,r,s,u);break;case"longueur":s=new iep.marqueSegment(this,r,iep.getAbs(c),iep.getOrd(c),iep.getCouleur(c),iep.getEpaisseur(c),c.getAttribute("forme"));x=new iep.actionCreation(this,r,s,u);break;case"texte":s=new iep.texte(this,r,iep.getAbs(c),iep.getOrd(c),iep.getCouleur(c),c.getAttribute("taille"));x=new iep.actionCreation(this,r,s,u);break;case"repere":s=new iep.repere(this,c.getAttribute("hauteur"),c.getAttribute("largeur"),c.getAttribute("haut"),c.getAttribute("gauche"),c.getAttribute("Xgrad"),c.getAttribute("Ygrad"),c.getAttribute("Xmin"),c.getAttribute("Xmax"),c.getAttribute("Ymin"),c.getAttribute("Ymax"),iep.getCouleur(c),c.getAttribute("grille"),c.getAttribute("axes"),c.getAttribute("etiquettes"));x=new iep.actionCreation(this,r,s,u);break;case"quadrillage":var f=c.getAttribute("abscisse_bas_droite");if(f!=null){f=parseFloat(f)/30;var j=parseFloat(c.getAttribute("ordonnee_bas_droite"))/30;var g=parseFloat(c.getAttribute("abscisse_haut_gauche"))/30;var k=parseFloat(c.getAttribute("ordonnee_haut_gauche"))/30;s=new iep.quadrillage(this,c.getAttribute("quadrillage"),String(j-k),String(f-g),k,g,iep.getCouleur(c));x=new iep.actionCreation(this,"quadrillageIEP",s,u)}else{s=new iep.quadrillage(this,c.getAttribute("quadrillage"),c.getAttribute("hauteur"),c.getAttribute("largeur"),c.getAttribute("haut"),c.getAttribute("gauche"),iep.getCouleur(c))}x=new iep.actionCreation(this,"quadrillageIEP",s,u);break;case"axe":s=new iep.axe(this,c.getAttribute("pente"),c.getAttribute("largeur"),c.getAttribute("haut"),c.getAttribute("gauche"),c.getAttribute("distanceBord"),c.getAttribute("Xgrad"),c.getAttribute("Xmin"),c.getAttribute("Xmax"),iep.getCouleur(c));x=new iep.actionCreation(this,r,s,u);break;default:x=null}if(x!=null){this.ajouteAction(x)}x.setReady()}break;case"montrer":z=c.getAttribute("objet");if(iep.estInstrument(z)){q=c.getAttribute("abscisse");d=c.getAttribute("ordonnee");x=new iep.actionMontrerInstrument(this,this[z],q,d,u);if(((z==="crayon")||(z==="compas"))&&(q!=null)&&(d!=null)){this[z].translate(parseFloat(q),parseFloat(d))}}else{x=new iep.actionMontrer(this,r,z,u)}this.ajouteAction(x);x.setReady();break;case"masquer":z=c.getAttribute("objet");if(iep.estInstrument(z)){x=new iep.actionMasquerInstrument(this,this[z],u)}else{x=new iep.actionMasquer(this,r,z,u)}this.ajouteAction(x);x.setReady();break;case"tracer":z=c.getAttribute("objet");var o=c.getAttribute("cible");if(o!=null){s=this.getElement(o,"point");q=s.xcons;d=s.ycons}else{q=parseFloat(iep.getAbs(c));d=parseFloat(iep.getOrd(c))}switch(z){case"crayon":n=c.getAttribute("forme");a=this.crayon.x;m=this.crayon.y;r=iep.getId(c);switch(n){case null:if(isNaN(q)||isNaN(d)){break}s=new iep.segment(this,r,a,m,q,d,iep.getCouleur(c),iep.getEpaisseur(c),iep.getOpaciteTrait(c),iep.getStyleTrait(c),iep.getStyle(c));this.crayon.translate(q,d);break;case"droite":if(isNaN(q)||isNaN(d)){break}s=new iep.droite(this,r,a,m,q,d,iep.getCouleur(c),iep.getEpaisseur(c),iep.getOpaciteTrait(c),iep.getStyleTrait(c),iep.getStyle(c));this.crayon.translate(q,d);break;case"demidroite":if(isNaN(q)||isNaN(d)){break}s=new iep.demiDroite(this,r,a,m,q,d,iep.getCouleur(c),iep.getEpaisseur(c),iep.getOpaciteTrait(c),iep.getStyleTrait(c),iep.getStyle(c));this.crayon.translate(q,d);break;case"libre":s=new iep.ligneContinue(this,r,this.crayon.x,this.crayon.y,c.getAttribute("abscisses"),c.getAttribute("ordonnees"),iep.getCouleur(c),iep.getEpaisseur(c),iep.getOpaciteTrait(c),iep.getStyleTrait(c),iep.getStyle(c));y=s.abs.length;this.crayon.translate(s.abs[y-1],s.ord[y-1]);break;case"polygone":i=c.getAttribute("cibles");if(i===null){s=new iep.polygone(this,r,c.getAttribute("abscisses"),c.getAttribute("ordonnees"),iep.getCouleur(c),iep.getEpaisseur(c),iep.getCouleurFond(c),c.getAttribute("opacite"))}else{w=this.getCoord(i);s=new iep.polygone(this,r,w.abs,w.ord,iep.getCouleur(c),iep.getEpaisseur(c),iep.getCouleurFond(c),c.getAttribute("opacite"))}y=s.abs.length;this.crayon.translate(s.abs[y-1],s.ord[y-1]);break}C=c.getAttribute("vitesse");if(C==null){C="4"}x=new iep.actionCreation(this,iep.getId(c),s,u,C);this.ajouteAction(x);x.setReady();break;case"trait":C=c.getAttribute("vitesse");if(C===null){C=10000}s=new iep.segment(this,r,c.getAttribute("abscisse1"),c.getAttribute("ordonnee1"),c.getAttribute("abscisse2"),c.getAttribute("ordonnee2"),iep.getCouleur(c),iep.getEpaisseur(c),iep.getOpaciteTrait(c),iep.getStyleTrait(c),iep.getStyle(c));x=new iep.actionCreation(this,iep.getId(c),s,u,C);this.ajouteAction(x);x.setReady();break;case"compas":s=new iep.arc(this,r,this.compas.x,this.compas.y,this.compas.ecart,this.getAngle(c,"debut"),this.getAngle(c,"fin"),iep.getCouleur(c),iep.getEpaisseur(c),iep.getOpaciteTrait(c),iep.getStyleTrait(c));C=c.getAttribute("sens");if(C==null){C="8"}x=new iep.actionCreation(this,iep.getId(c),s,u,C);this.ajouteAction(x);x.setReady();break;case"angle_droit":s=new iep.angleDroit(this,r,c.getAttribute("abscisse_sommet"),c.getAttribute("ordonnee_sommet"),c.getAttribute("abscisse_inter"),c.getAttribute("ordonnee_inter"),iep.getCouleur(c),iep.getEpaisseur(c));x=new iep.actionCreation(this,iep.getId(c),s,u,C);this.ajouteAction(x);x.setReady();break}break;case"rotation":z=c.getAttribute("objet");D=c.getAttribute("sens");if(iep.estInstrument(z)){var o=c.getAttribute("cible");if((o!=null)&&(c.getAttribute("angle")===null)){s=this.getElement(o,"point");q=s.xcons;d=s.ycons;var t=new iep.vect(this[z].x,this[z].y,q,d);if(t.presqueNul()){A=0}else{A=-t.angle()}}else{if(z==="compas"){A=this.getAngle(c,"angle")}else{A=c.getAttribute("angle")}}x=new iep.actionRotationInstrument(this,this[z],A,u,D)}else{A=c.getAttribute("angle");x=new iep.actionRotationObjet(this,r,A,z,u,D)}this.ajouteAction(x);x.setReady();break;case"translation":z=c.getAttribute("objet");var o=c.getAttribute("cible");if(o!=null){s=this.getElement(o,"point");q=s.xcons;d=s.ycons}else{q=parseFloat(iep.getAbs(c));d=parseFloat(iep.getOrd(c))}C=c.getAttribute("vitesse");if(iep.estInstrument(z)){this[z].x=q;this[z].y=d;x=new iep.actionTranslationInstrument(this,this[z],q,d,u,C)}else{if(z==="point"){v=this.getElement(r,"point");v.xcons=q;v.ycons=d}x=new iep.actionTranslationObjet(this,r,q,d,z,u,C)}this.ajouteAction(x);if((z==="crayon")||(z==="compas")){this[z].translate(q,d)}x.setReady();break;case"zoom":z=c.getAttribute("objet");C=c.getAttribute("vitesse");if(iep.estInstrument(z)){h=c.getAttribute("echelle");this[z].zoomfactor=parseFloat(h)/100;x=new iep.actionZoomInstrument(this,this[z],h,u,C)}else{x=new iep.actionZoomObjet(this,r,c.getAttribute("echelle"),z,u,C)}this.ajouteAction(x);x.setReady();break;case"ecarter":var o=c.getAttribute("cible");if(o!=null){s=this.getElement(o,"point");t=new iep.vect(this.compas.x,this.compas.y,s.xcons,s.ycons);b=t.norme()}else{b=parseFloat(c.getAttribute("ecart"))*this.compas.zoomfactor}this.compas.ecart=b;x=new iep.actionEcarterCompas(this,b,u,c.getAttribute("vitesse"));this.ajouteAction(x);x.setReady();break;case"lever":x=new iep.actionLeverCompas(this,u);this.ajouteAction(x);x.setReady();break;case"coucher":x=new iep.actionCoucherCompas(this,u);this.ajouteAction(x);x.setReady();break;case"masquer_nombres":x=new iep.actionMontrerNombres(this,false,u);this.ajouteAction(x);x.setReady();break;case"montrer_nombres":x=new iep.actionMontrerNombres(this,true,u);this.ajouteAction(x);x.setReady();break;case"graduations":z=c.getAttribute("objet");x=new iep.actionMontrerGraduations(this,this[z],true,u);this.ajouteAction(x);x.setReady();break;case"vide":z=c.getAttribute("objet");x=new iep.actionMontrerGraduations(this,this[z],false,u);this.ajouteAction(x);x.setReady();break;case"retourner":this.compasRetourne=!this.compasRetourne;x=new iep.actionRetourner(this,u);this.ajouteAction(x);x.setReady();break;case"glisser":x=new iep.actionGlisser(this,c.getAttribute("abscisse"),u,c.getAttribute("vitesse"));this.ajouteAction(x);x.setReady();break;case"chargement":s=new iep.image(this,r,c.getAttribute("url"));s.prepareAction();break;case"ecrire":x=new iep.actionEcrireTexte(this,r,iep.getCouleur(c),c.getAttribute("taille"),c.getAttribute("texte"),c.getAttribute("style"),iep.getCouleurFondTexte(c),c.getAttribute("opacite_fond"),iep.getCouleurCadre(c),c.getAttribute("epaisseur_cadre"),c.getAttribute("marge"),c.getAttribute("marge_gauche"),c.getAttribute("marge_droite"),c.getAttribute("marge_haut"),c.getAttribute("marge_bas"),u);this.ajouteAction(x);x.prepare();break;case"nommer":s=new iep.nomPoint(this,r,iep.getAbs(c),iep.getOrd(c),c.getAttribute("nom"),iep.getCouleur(c));x=new iep.actionNommerPoint(this,s,u);this.ajouteAction(x);x.prepare();break;case"pause":x=new iep.actionPause(this,u);this.ajouteAction(x);x.setReady();break;case"modifier_longueur":z=c.getAttribute("objet");x=new iep.actionModifierLongueur(this,this[z],c.getAttribute("longueur"),u);this.ajouteAction(x);x.setReady();break}}catch(B){}}this.waitForReadyState()};iep.iepDoc.prototype.execute=function(a){this.indiceActionEnCours=0;this.actions[0].execute(a)};iep.iepDoc.prototype.actionSuivante=function(a){var d=(arguments.length===0)?false:a;if(!this.animationEnCours&&!d){return}var c=this.actions[this.indiceActionEnCours];if((c.tempo===null)||d){this.passageActionSuivante(d)}else{var b=this;setTimeout(function(){b.passageActionSuivante(d)},c.tempo)}};iep.iepDoc.prototype.passageActionSuivante=function(a){if(this.indiceActionEnCours!==this.actions.length-1){this.indiceActionEnCours++;this.actions[this.indiceActionEnCours].execute(a)}else{this.indiceActionEnCours++;this.montreIcone("GoBegin",true);this.montreIcone("StepPrev",true);this.montreIcone("Pause",false);this.montreIcone("Play",false);this.montreIcone("StepNext",false);this.montreIcone("GoEnd",false);this.montreIcone("Restart",true);this.montreIcone("XML",true);this.animationEnCours=false}};iep.getCouleur=function(b){var a=b.getAttribute("couleur");if(a==null){return"black"}else{return iep.couleur(a)}};iep.getCouleurCadre=function(b){var a=b.getAttribute("couleur_cadre");if(a==null){return null}else{return iep.couleur(a)}};iep.getCouleurFond=function(b){var a=b.getAttribute("couleur_fond");if(a==null){return null}else{return iep.couleur(a)}};iep.getCouleurFondTexte=function(b){var a=b.getAttribute("couleur_fond");if(a==null){return null}else{return iep.couleur(a)}};iep.getEpaisseur=function(b){var a=b.getAttribute("epaisseur");if((a==null)||(a==0)){return"1"}else{return a}};iep.getOpaciteTrait=function(a){var b=a.getAttribute("opacite");if(b==null){return"100"}else{return b}};iep.getOpaciteFond=function(a){var b=a.getAttribute("opacite");if(b==null){return"50"}else{return b}};iep.getStyleTrait=function(b){var a=b.getAttribute("pointille");if(a==null){return"continu"}else{return a}};iep.getStyle=function(b){var a=b.getAttribute("style");if(a==null){return"normal"}else{return a}};iep.getId=function(a){return a.getAttribute("id")};iep.getAbs=function(a){return a.getAttribute("abscisse")};iep.getOrd=function(a){return a.getAttribute("ordonnee")};iep.iepDoc.prototype.getCoord=function(d){var j,f,k,c,h,g,b;k="";c="";j=d.split(",");g=j.length;for(f=0;f<g;f++){b=(f===0)?"":",";var e=this.getElement(j[f],"point");k+=b+e.xcons;c+=b+e.ycons}h=new Object();h.abs=k;h.ord=c;return h};iep.iepDoc.prototype.getAngle=function(c,d){var b=c.getAttribute(d);if(b==null){return null}if(this.compasRetourne){return String(parseFloat(b)+180)}else{return b}};iep.iconePlay=function(b,g,f){var c=document.createElementNS(iep.svgsn,"svg");c.setAttribute("x",b);c.setAttribute("y",g);c.setAttribute("width",32);c.setAttribute("height",32);var d=document.createElementNS(iep.svgsn,"circle");c.appendChild(d);d.setAttribute("cx",16);d.setAttribute("cy",16);d.setAttribute("r",15);var a=(f==="fonce")?"filtrebleu":"filtregris";d.setAttribute("style","stroke:none;fill:url(#radial"+f+"); filter:url(#"+a+");");var e=document.createElementNS(iep.svgsn,"polygon");e.setAttribute("points","-5,8 8,0 -5,-8");e.setAttribute("style","stroke:white;fill:white;");e.setAttribute("transform","translate(16,16)");c.appendChild(e);return c};iep.iconePause=function(b,g,f){var c=document.createElementNS(iep.svgsn,"svg");c.setAttribute("x",b);c.setAttribute("y",g);c.setAttribute("width",32);c.setAttribute("height",32);var d=document.createElementNS(iep.svgsn,"circle");c.appendChild(d);d.setAttribute("cx",16);d.setAttribute("cy",16);d.setAttribute("r",15);var a=(f==="fonce")?"filtrebleu":"filtregris";d.setAttribute("style","stroke:none;fill:url(#radial"+f+"); filter:url(#"+a+");");var e=document.createElementNS(iep.svgsn,"rect");e.setAttribute("x",-6);e.setAttribute("y",-7);e.setAttribute("width",3);e.setAttribute("height",14);e.setAttribute("style","stroke:white;fill:white;");e.setAttribute("transform","translate(16,16)");c.appendChild(e);e=document.createElementNS(iep.svgsn,"rect");e.setAttribute("x",2);e.setAttribute("y",-7);e.setAttribute("width",3);e.setAttribute("height",14);e.setAttribute("style","stroke:white;fill:white;");e.setAttribute("transform","translate(16,16)");c.appendChild(e);return c};iep.iconeStepNext=function(b,h,g){var c=document.createElementNS(iep.svgsn,"svg");c.setAttribute("x",b);c.setAttribute("y",h);c.setAttribute("width",32);c.setAttribute("height",32);var d=document.createElementNS(iep.svgsn,"circle");c.appendChild(d);d.setAttribute("cx",16);d.setAttribute("cy",16);d.setAttribute("r",15);var a=(g==="fonce")?"filtrebleu":"filtregris";d.setAttribute("style","stroke:none;fill:url(#radial"+g+"); filter:url(#"+a+");");var f=document.createElementNS(iep.svgsn,"rect");f.setAttribute("x",5);f.setAttribute("y",-6);f.setAttribute("width",3);f.setAttribute("height",12);f.setAttribute("style","stroke:white;fill:white;");f.setAttribute("transform","translate(16,16)");c.appendChild(f);var e=document.createElementNS(iep.svgsn,"polygon");e.setAttribute("points","-7,6 2,0 -7,-6");e.setAttribute("style","stroke:white;fill:white;");e.setAttribute("transform","translate(16,16)");c.appendChild(e);return c};iep.iconeStepPrev=function(b,h,g){var c=document.createElementNS(iep.svgsn,"svg");c.setAttribute("x",b);c.setAttribute("y",h);c.setAttribute("width",32);c.setAttribute("height",32);var d=document.createElementNS(iep.svgsn,"circle");c.appendChild(d);d.setAttribute("cx",16);d.setAttribute("cy",16);d.setAttribute("r",15);var a=(g==="fonce")?"filtrebleu":"filtregris";d.setAttribute("style","stroke:none;fill:url(#radial"+g+"); filter:url(#"+a+");");var f=document.createElementNS(iep.svgsn,"rect");f.setAttribute("x",-7);f.setAttribute("y",-6);f.setAttribute("width",3);f.setAttribute("height",12);f.setAttribute("style","stroke:white;fill:white;");f.setAttribute("transform","translate(16,16)");c.appendChild(f);var e=document.createElementNS(iep.svgsn,"polygon");e.setAttribute("points","7,6 -2,0 7,-6");e.setAttribute("style","stroke:white;fill:white;");e.setAttribute("transform","translate(16,16)");c.appendChild(e);return c};iep.iconeGoEnd=function(b,g,f){var c=document.createElementNS(iep.svgsn,"svg");c.setAttribute("x",b);c.setAttribute("y",g);c.setAttribute("width",32);c.setAttribute("height",32);var d=document.createElementNS(iep.svgsn,"circle");c.appendChild(d);d.setAttribute("cx",16);d.setAttribute("cy",16);d.setAttribute("r",15);var a=(f==="fonce")?"filtrebleu":"filtregris";d.setAttribute("style","stroke:none;fill:url(#radial"+f+"); filter:url(#"+a+");");var e=document.createElementNS(iep.svgsn,"polygon");e.setAttribute("points","-6,7 1,0 -6,-7");e.setAttribute("style","stroke:white;fill:white;");e.setAttribute("transform","translate(16,16)");c.appendChild(e);var e=document.createElementNS(iep.svgsn,"polygon");e.setAttribute("points","3,7 10,0 3,-7");e.setAttribute("style","stroke:white;fill:white;");e.setAttribute("transform","translate(16,16)");c.appendChild(e);return c};iep.iconeGoBegin=function(b,g,f){var c=document.createElementNS(iep.svgsn,"svg");c.setAttribute("x",b);c.setAttribute("y",g);c.setAttribute("width",32);c.setAttribute("height",32);var d=document.createElementNS(iep.svgsn,"circle");c.appendChild(d);d.setAttribute("cx",16);d.setAttribute("cy",16);d.setAttribute("r",15);var a=(f==="fonce")?"filtrebleu":"filtregris";d.setAttribute("style","stroke:none;fill:url(#radial"+f+"); filter:url(#"+a+");");var e=document.createElementNS(iep.svgsn,"polygon");e.setAttribute("points","6,7 -1,0 6,-7");e.setAttribute("style","stroke:white;fill:white;");e.setAttribute("transform","translate(16,16)");c.appendChild(e);var e=document.createElementNS(iep.svgsn,"polygon");e.setAttribute("points","-3,7 -10,0 -3,-7");e.setAttribute("style","stroke:white;fill:white;");e.setAttribute("transform","translate(16,16)");c.appendChild(e);return c};iep.iconeRestart=function(b,g,f){var c=document.createElementNS(iep.svgsn,"svg");c.setAttribute("x",b);c.setAttribute("y",g);c.setAttribute("width",32);c.setAttribute("height",32);var d=document.createElementNS(iep.svgsn,"circle");c.appendChild(d);d.setAttribute("cx",16);d.setAttribute("cy",16);d.setAttribute("r",15);var a=(f==="fonce")?"filtrebleu":"filtregris";d.setAttribute("style","stroke:none;fill:url(#radial"+f+"); filter:url(#"+a+");");var e=document.createElementNS(iep.svgsn,"path");e.setAttribute("d","M 0 -8 A 8 8 -90 1 1 -8 0");e.setAttribute("style","stroke:white;stroke-width:3;fill:none;");e.setAttribute("marker-end","url(#markerarrow");e.setAttribute("transform","translate(16,16)");c.appendChild(e);return c};iep.iconeXML=function(b,g,f){var c=document.createElementNS(iep.svgsn,"svg");c.setAttribute("x",b);c.setAttribute("y",g);c.setAttribute("width",32);c.setAttribute("height",32);var d=document.createElementNS(iep.svgsn,"circle");c.appendChild(d);d.setAttribute("cx",16);d.setAttribute("cy",16);d.setAttribute("r",15);var a=(f==="fonce")?"filtrebleu":"filtregris";d.setAttribute("style","stroke:none;fill:url(#radial"+f+"); filter:url(#"+a+");");var e=document.createElementNS(iep.svgsn,"text");e.setAttribute("pointer-events","none");e.appendChild(document.createTextNode("XML"));e.setAttribute("x",16);e.setAttribute("y",21);e.setAttribute("style","font-family:Arial;font-size:9pt;fill:white;text-anchor:middle");c.appendChild(e);return c};iep.iepDoc.prototype.creeElementsPourIcones=function(){var a=document.createElementNS(iep.svgsn,"defs");a.appendChild(iep.radialGradiant("#9999FF","#000099","radialfonce"));this.svg.appendChild(a);a=document.createElementNS(iep.svgsn,"defs");a.appendChild(iep.radialGradiant("#CCCCCC","#666666","radialclair"));this.svg.appendChild(a);a=document.createElementNS(iep.svgsn,"defs");a.appendChild(iep.radialGradiant("#FF9999","#FF0000","radialrouge"));this.svg.appendChild(a);a=document.createElementNS(iep.svgsn,"defs");a.appendChild(iep.markerArrow("markerarrow"));this.barreIcones.appendChild(a);a=document.createElementNS(iep.svgsn,"defs");a.appendChild(iep.filtreEclairageIcone("filtrebleu"));this.barreIcones.appendChild(a);a=document.createElementNS(iep.svgsn,"defs");a.appendChild(iep.filtreEclairageIcone("filtregris"));this.barreIcones.appendChild(a)};iep.radialGradiant=function(e,a,d){var b=document.createElementNS(iep.svgsn,"radialGradient");b.setAttribute("id",d);var c=document.createElementNS(iep.svgsn,"stop");c.setAttribute("offset","0%");c.setAttribute("style","stop-color:"+a+";");b.appendChild(c);c=document.createElementNS(iep.svgsn,"stop");c.setAttribute("offset","80%");c.setAttribute("style","stop-color:"+e+";");b.appendChild(c);c=document.createElementNS(iep.svgsn,"stop");c.setAttribute("offset","100%");c.setAttribute("style","stop-color:"+a+";");b.appendChild(c);return b};iep.markerArrow=function(c){var a=document.createElementNS(iep.svgsn,"marker");a.setAttribute("id",c);a.setAttribute("markerWidth","4");a.setAttribute("markerHeight","4");a.setAttribute("refX","0");a.setAttribute("refY","2");a.setAttribute("orient","auto");var b=document.createElementNS(iep.svgsn,"path");b.setAttribute("d","M 0 0 2 2 0 4 Z");b.setAttribute("style","fill:white;");a.appendChild(b);return a};iep.filtreEclairageIcone=function(e){var d=document.createElementNS(iep.svgsn,"filter");d.setAttribute("x","0");d.setAttribute("y","0");d.setAttribute("width","100%");d.setAttribute("height","100%");d.setAttribute("color-interpolation-filters","sRGB");var a=document.createElementNS(iep.svgsn,"feDiffuseLighting");a.setAttribute("lighting-color","white");a.setAttribute("surfaceScale","1");a.setAttribute("diffuseConstant","1.2");a.setAttribute("in","SourceGraphic");a.setAttribute("result","diffOut");var b=document.createElementNS(iep.svgsn,"fePointLight");b.setAttribute("x","5");b.setAttribute("y","5");b.setAttribute("z","15");a.appendChild(b);d.appendChild(a);var c=document.createElementNS(iep.svgsn,"feComposite");c.setAttribute("in","SourceGraphic");c.setAttribute("in2","diffOut");c.setAttribute("operator","arithmetic");c.setAttribute("k1","1");c.setAttribute("k2","0");c.setAttribute("k3","0");c.setAttribute("k4","0");d.appendChild(c);d.setAttribute("id",e);return d};iep.iepDoc.prototype.popup=function(){var a=window.open("","popup","width=700,height=450,toolbar=no,scrollbars=no,resizable=yes");a.iepDoc=this;var e=a.document;e.title="Code Xml de la figure";var f=document.createElement("div");var d=document.createElement("form");f.appendChild(d);f.setAttribute("align","center");e.body.appendChild(f);var b=document.createElement("textarea");d.appendChild(b);b.setAttribute("cols",80);b.setAttribute("rows",25);b.setAttribute("readonly",true);b.style.fontSize="13px";b.scrollIntoView();var c=this.codexml;c=c.replace(/>\s*</g,">\n<");b.appendChild(document.createTextNode(c));b.select();a.addEventListener("unload",function(){this.iepDoc.windowxml=null});return a};iep.cc1=["noir","rouge","vert","bleu","blanc","gris"];iep.cc2=["black","red","green","blue","white","grey"];iep.couleur=function(d){var b,c,a;if(d==="0"){return"black"}for(b=0;b<iep.cc1.length;b++){if(iep.cc1[b]===d){return iep.cc2[b]}}if(d.substring(0,2)==="0x"){c="000000"+d.substring(2);a=c.substring(c.length-6);d="#"+a}else{if(iep.chiffre(d.charAt(0))){d=parseFloat(d).toString(16);c="000000"+d;a=c.substring(c.length-6);d="#"+a}else{if(d.charAt(0)==="#"){c="000000"+d.substring(1);a=c.substring(c.length-6);d="#"+a}}}return d};iep.vect=function(b,d,a,c){if(arguments.length>2){this.x=a-b;this.y=c-d}else{this.x=b;this.y=d}};iep.vect.prototype.presqueNul=function(){return iep.zero(this.x)&&iep.zero(this.y)};iep.vect.prototype.norme=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};iep.vect.prototype.vecteurColineaire=function(b){var a=this.norme();return new iep.vect(this.x/a*b,this.y/a*b)};iep.vect.prototype.tourne=function(b){var a,c;a=Math.cos(b*iep.convDegRad);c=Math.sin(b*iep.convDegRad);return new iep.vect(a*this.x-c*this.y,a*this.y+c*this.x)};iep.vect.prototype.angle=function(){var a;if((this.x===0)&&(this.y===0)){return 0}else{if(this.x===0){if(this.y>0){a=3*Math.PI/2}else{a=Math.PI/2}}else{if(this.x>=0){a=Math.atan(-this.y/this.x)}else{a=Math.PI-Math.atan(this.y/this.x)}if(a<0){a=a+2*Math.PI}}}return a*iep.convRadDeg};iep.instrumentAncetre=function(a){this.doc=a;this.x=200;this.y=400;this.angle=0;this.zoomfactor=1;this.visible=false};iep.instrumentAncetre.prototype.montre=function(a){this.visible=a;this.g.setAttribute("visibility",a?"visible":"hidden")};iep.instrumentAncetre.prototype.updateg=function(){this.initialisePosition();this.doc.svg.removeChild(this.g);this.doc.svg.appendChild(this.g)};iep.instrumentAncetre.prototype.translate=function(a,b){this.setPosition(a,b,this.angle,this.zoomfactor)};iep.instrumentAncetre.prototype.angleInit=function(){return 0};iep.instrumentAncetre.prototype.setPosition=function(a,e,d,c){var b;this.x=a;this.y=e;this.angle=d;if(arguments.length>=4){b=c;this.zoomfactor=b}else{b=this.zoomfactor}this.g.setAttribute("transform","scale("+b+") translate("+String(a/b)+","+String(e/b)+") rotate("+d+")")};iep.instrumentAncetre.prototype.initialisePosition=function(){this.setPosition(200,400,this.angleInit(),1)};iep.instrumentAncetre.prototype.lanceAnimationTranslation=function(b,e,c){this.xfin=b;this.yfin=e;this.pix=Math.abs(c/2);var a=new iep.vect(this.x,this.y,b,e);this.dist=a.norme();if(this.dist==0){this.doc.actionSuivante();return}this.vect=a.vecteurColineaire(this.pix);var d=this;this.timer=setInterval(function(){iep.instrumentAncetre.actionPourTranslation.call(d)},25)};iep.instrumentAncetre.actionPourTranslation=function(){var a=this.x+this.vect.x;var e=this.y+this.vect.y;var b=new iep.vect(a,e,this.xfin,this.yfin);var c=b.norme();if((c>this.dist)||!this.doc.animationEnCours){this.setPosition(this.xfin,this.yfin,this.angle);if(this==this.doc.compas){if((this.doc.compasLeve!=null)&&(this.doc.compasLeve.visible)){this.doc.compasLeve.setPosition(this.xfin,this.yfin,this.angle)}}clearInterval(this.timer);this.doc.actionSuivante();return}else{this.dist=c;this.setPosition(a,e,this.angle);if(this==this.doc.compas){if((this.doc.compasLeve!=null)&&(this.doc.compasLeve.visible)){this.doc.compasLeve.setPosition(a,e,this.angle)}}}};iep.instrumentAncetre.prototype.lanceAnimationRotation=function(b,a){var f=iep.mesurePrincDeg(this.angle);var e=iep.mesurePrincDeg(b);if(Math.abs(e-f)>180){if(e>f){e=e-360}else{e=e+360}}this.anglefin=e;this.angle=f;this.pasdeg=a/3;var d=(e>=f)?1:-1;this.pasdeg*=d;this.distang=Math.abs(e-this.angle);var c=this;this.timer=setInterval(function(){iep.instrumentAncetre.actionPourRotation.call(c)},25)};iep.instrumentAncetre.actionPourRotation=function(){var b=parseFloat(this.angle)+parseFloat(this.pasdeg);var a=Math.abs(b-this.anglefin);if((a>this.distang)||!this.doc.animationEnCours){this.setPosition(this.x,this.y,this.anglefin);clearInterval(this.timer);this.doc.actionSuivante();return}else{this.distang=a;this.setPosition(this.x,this.y,b)}};iep.instrumentAncetre.prototype.lanceAnimationZoom=function(a,c){this.zoomfin=a;this.vitesse=parseInt(c);this.pas=this.vitesse*0.05*(this.zoomfin-this.zoomfactor);this.senspos=(this.pas>=0);var b=this;this.timer=setInterval(function(){iep.instrumentAncetre.actionPourZoom.call(b)},100)};iep.instrumentAncetre.actionPourZoom=function(){var a=this.zoomfactor+this.pas;if(this.doc.animationEnCours&&((this.senspos&&(a<this.zoomfin))||(!this.senspos&&(a>this.zoomfin)))){this.setPosition(this.x,this.y,this.angle,a)}else{this.zoomfactor=this.zoomfin;this.positionne();clearInterval(this.timer);this.doc.actionSuivante();return}};iep.instrumentAncetre.prototype.positionne=function(){this.setPosition(this.x,this.y,this.angle,this.zoomfactor)};iep.regle=function(a){iep.instrumentAncetre.call(this,a);this.x=100;this.y=400;this.angle=0;this.longueur=15;this.graduationVisible=true;this.creeg();this.g.setAttribute("visibility","hidden");this.setPosition(this.x,this.y,this.angle);a.svg.appendChild(this.g)};iep.regle.prototype=new iep.instrumentAncetre();iep.regle.prototype.creeg=function(){var m,n;var a=9;var l=this.longueur*30+15;var j=57;var f=String(j);var k=6;var d=String(k);var c=document.createElementNS(iep.svgsn,"g");var e=document.createElementNS(iep.svgsn,"rect");e.setAttribute("x",-d-1);e.setAttribute("y",0);e.setAttribute("width",String(l+k+1));e.setAttribute("height",f);e.setAttribute("rx",d);e.setAttribute("ry",d);e.setAttribute("style","stroke:#999999;stroke-width:2; fill: #c6cbe8; fill-opacity: 0.5");c.appendChild(e);var o=document.createElementNS(iep.svgsn,"line");o.setAttribute("x1",-d);o.setAttribute("y1",27);o.setAttribute("x2",l);o.setAttribute("y2",27);o.setAttribute("style","stroke:#999999;stroke-width:2;");c.appendChild(o);this.graduations=document.createElementNS(iep.svgsn,"g");for(var b=0;b<=this.longueur*10;b++){m=document.createElementNS(iep.svgsn,"line");var h=3*b;m.setAttribute("x1",h);m.setAttribute("y1",0);m.setAttribute("x2",h);m.setAttribute("y2",b%10===0?12:(b%5===0?9:6));if(b%10===0){n=document.createElementNS(iep.svgsn,"text");n.setAttribute("pointer-events","none");n.appendChild(document.createTextNode(String(b/10)));n.setAttribute("x",h);n.setAttribute("y",12+a);n.setAttribute("style","font-family: monospace;font-size: "+a+"pt;text-anchor:middle");this.graduations.appendChild(n)}m.setAttribute("style","stroke:black;stroke-width:0.7;");this.graduations.appendChild(m)}n=document.createElementNS(iep.svgsn,"text");n.setAttribute("pointer-events","none");n.appendChild(document.createTextNode("Sésamath"));n.setAttribute("x",l/2-k-3);n.setAttribute("y",f-5);n.setAttribute("style","font-family: Arial;font-size: 8pt;font-weight:bold;fill: maroon;text-anchor:middle;");c.appendChild(n);c.appendChild(this.graduations);this.g=c};iep.regle.prototype.montreGraduations=function(a){this.graduationVisible=a;this.graduations.setAttribute("visibility",this.visible?"visible":"hidden")};iep.regle.prototype.montre=function(a){iep.instrumentAncetre.prototype.montre.call(this,a);if(a){this.graduations.setAttribute("visibility",this.graduationVisible?"visble":"hidden")}else{this.graduations.setAttribute("visibility","hidden")}};iep.rapporteur=function(a){iep.instrumentAncetre.call(this,a);this.graduationExterneVisible=true;this.graduationInterneVisible=true;this.creeg();this.g.setAttribute("visibility","hidden");this.setPosition(this.x,this.y,this.angle);a.svg.appendChild(this.g)};iep.rapporteur.prototype=new iep.instrumentAncetre();iep.rapporteur.prototype.creeg=function(){var t,b,h,q,e,s,a;var c=10;var r=9;var m="13";var o=156;var k=String(o);var f=89;var j=String(f);var d="116";var n="7";h=document.createElementNS(iep.svgsn,"g");b=document.createElementNS(iep.svgsn,"path");t="M "+k+" 0 A "+k+" "+k+" 0 0 0 -"+k+" 0 L -"+k+" "+m+" L "+k+" "+m+" L "+k+" 0";t+="M 0 0 L -"+j+" 0 A "+j+" "+j+" 0 0 1 "+j+" 0 Z";b.setAttribute("d",t);b.setAttribute("style","stroke:#999999;stroke-width:1; fill: #c6cbe8; fill-opacity: 0.5");h.appendChild(b);b=document.createElementNS(iep.svgsn,"path");t="M "+n+" 0 A "+n+" "+n+" 0 0 0 -"+n+" 0 M 0 0 L 0 -"+n;b.setAttribute("d",t);b.setAttribute("style","stroke: #666666;stroke-width:1; fill: none");h.appendChild(b);for(e=0;e<=180;e++){q=document.createElementNS(iep.svgsn,"line");q.setAttribute("x1",k);q.setAttribute("y1",0);q.setAttribute("x2",e%10===0?o-20:(e%5===0?o-10:o-5));q.setAttribute("y2",0);q.setAttribute("transform","rotate(-"+e+")");q.setAttribute("style","stroke: #333333;stroke-width:0.7;");h.appendChild(q)}this.gradext=document.createElementNS(iep.svgsn,"g");for(e=0;e<=180;e++){if(e%10===0){s=document.createElementNS(iep.svgsn,"text");s.setAttribute("pointer-events","none");s.appendChild(document.createTextNode(e));s.setAttribute("x",0);s.setAttribute("y",0);s.setAttribute("style","font-family: arial;font-size: "+c+"px;text-anchor: middle; fill: black");s.setAttribute("transform"," scale(-1) rotate("+String(-e-90)+") translate(0,"+String(-o+22+c)+")");this.gradext.appendChild(s)}}h.appendChild(this.gradext);var l=o-26-c;b=document.createElementNS(iep.svgsn,"path");t="M "+String(l)+" 0 L "+d+" 0 A "+d+" "+d+" 0 0 0 -"+d+" 0 L "+String(-l)+" 0";b.setAttribute("d",t);b.setAttribute("style","stroke: #666666;stroke-width:1; fill: none");h.appendChild(b);for(e=0;e<=18;e++){q=document.createElementNS(iep.svgsn,"line");q.setAttribute("x1",f);q.setAttribute("y1",0);q.setAttribute("x2",f+10);q.setAttribute("y2",0);q.setAttribute("transform","rotate(-"+String(10*e)+")");q.setAttribute("style","stroke: #333333;stroke-width:0.7;");h.appendChild(q)}this.gradint=document.createElementNS(iep.svgsn,"g");for(e=0;e<=18;e++){s=document.createElementNS(iep.svgsn,"text");s.setAttribute("pointer-events","none");s.appendChild(document.createTextNode(180-10*e));s.setAttribute("x",0);s.setAttribute("y",0);s.setAttribute("style","font-family: arial;font-size: "+r+"px;text-anchor: middle; fill: black");s.setAttribute("transform","scale(-1) rotate("+String(-10*e-90)+") translate(0,"+String(-f-14)+")");this.gradint.appendChild(s)}h.appendChild(this.gradint);a=document.createElementNS(iep.svgsn,"circle");a.setAttribute("cx",0);a.setAttribute("cy",0);a.setAttribute("r",2);a.setAttribute("style","stroke: black; stroke-width: 1;fill: none");h.appendChild(a);s=document.createElementNS(iep.svgsn,"text");s.setAttribute("pointer-events","none");s.appendChild(document.createTextNode("Sésamath"));s.setAttribute("x",0);s.setAttribute("y",m-2);s.setAttribute("style","font-family: sans-serif;font-size: 7pt;font-weight:bold;text-anchor: middle; fill: maroon");h.appendChild(s);this.g=h};iep.rapporteur.prototype.montreGraduations=function(a){this.graduationInterneVisible=true;if(this.visible){this.gradint.setAttribute("visibility",a?"visible":"hidden")}};iep.rapporteur.prototype.montreGraduationsExternes=function(a){this.graduationExterneVisible=true;if(this.visible){this.gradext.setAttribute("visibility",a?"visible":"hidden")}};iep.rapporteur.prototype.montre=function(a){iep.instrumentAncetre.prototype.montre.call(this,a);if(a){this.gradint.setAttribute("visibility",this.graduationInterneVisible?"visible":"hidden");this.gradext.setAttribute("visibility",this.graduationExterneVisible?"visible":"hidden")}else{this.gradint.setAttribute("visibility","hidden");this.gradext.setAttribute("visibility","hidden")}};iep.equerre=function(a){iep.instrumentAncetre.call(this,a);this.creeg();this.g.setAttribute("visibility","hidden");this.setPosition(this.x,this.y,this.angle);a.svg.appendChild(this.g)};iep.equerre.prototype=new iep.instrumentAncetre();iep.equerre.prototype.creeg=function(){var k,b,r,n,o;var m=131;var a=223;var e=31;var d=24;var c=61;var i=c*a/m;var q=16;var j=a/m*(m-q);var f=m/a*(a-q);k=document.createElementNS(iep.svgsn,"g");b=document.createElementNS(iep.svgsn,"path");r="M 0 0 L "+m+" 0 L 0 "+String(-a)+" Z";n="M "+d+" "+String(-e)+" L "+d+" "+String(-e-i)+" L "+String(d+c)+" "+String(-e)+" Z";r+=n;b.setAttribute("d",r);b.setAttribute("style","stroke:black;stroke-width:0.75; fill: #c6cbe8; fill-opacity: 0.5");k.appendChild(b);b=document.createElementNS(iep.svgsn,"path");r="M "+q+" "+String(-q)+" L "+f+" "+String(-q)+" L "+q+" "+(-j)+" Z";r+=n;b.setAttribute("d",r);b.setAttribute("style","stroke-width:0; fill: #c6cbe8; fill-opacity: 0.5");k.appendChild(b);o=document.createElementNS(iep.svgsn,"text");o.setAttribute("pointer-events","none");o.appendChild(document.createTextNode("Sésamath"));o.setAttribute("x",d);o.setAttribute("y",-q/2-5);o.setAttribute("style","font-family: Arial;font-size: 8pt;font-weight:bold;fill: maroon");k.appendChild(o);this.g=k;return k};iep.crayon=function(a){iep.instrumentAncetre.call(this,a);this.angle=this.angleInit();this.creeg();this.g.setAttribute("visibility","hidden");this.setPosition(this.x,this.y,this.angle);a.svg.appendChild(this.g)};iep.crayon.prototype=new iep.instrumentAncetre();iep.crayon.prototype.angleInit=function(){return -40};iep.crayon.prototype.creeg=function(){var l,h,f,q,n,o,m,a;var c=97;var e=15;var k=4.5;var j=3;var i=j/e*k;l=document.createElementNS(iep.svgsn,"g");h=document.createElementNS(iep.svgsn,"defs");o=document.createElementNS(iep.svgsn,"linearGradient");o.setAttribute("id","gradpointe");m=document.createElementNS(iep.svgsn,"stop");m.setAttribute("offset","0%");m.setAttribute("style","stop-color: #f00000;");o.appendChild(m);m=document.createElementNS(iep.svgsn,"stop");m.setAttribute("offset","50%");m.setAttribute("style","stop-color: #eeb444;");o.appendChild(m);m=document.createElementNS(iep.svgsn,"stop");m.setAttribute("offset","100%");m.setAttribute("style","stop-color: #f00000");o.appendChild(m);o.setAttribute("x1","0%");o.setAttribute("y1","0%");o.setAttribute("x2","0%");o.setAttribute("y2","100%");h.appendChild(o);l.appendChild(h);h=document.createElementNS(iep.svgsn,"defs");o=document.createElementNS(iep.svgsn,"linearGradient");o.setAttribute("id","gradcorps");m=document.createElementNS(iep.svgsn,"stop");m.setAttribute("offset","0%");m.setAttribute("style","stop-color: #810216;");o.appendChild(m);m=document.createElementNS(iep.svgsn,"stop");m.setAttribute("offset","25%");m.setAttribute("style","stop-color: #c64f00;");o.appendChild(m);m=document.createElementNS(iep.svgsn,"stop");m.setAttribute("offset","50%");m.setAttribute("style","stop-color: #ab4a36");o.appendChild(m);m=document.createElementNS(iep.svgsn,"stop");m.setAttribute("offset","75%");m.setAttribute("style","stop-color: #c64f00;");o.appendChild(m);m=document.createElementNS(iep.svgsn,"stop");m.setAttribute("offset","100%");m.setAttribute("style","stop-colr: #810216;");o.appendChild(m);o.setAttribute("x1","0%");o.setAttribute("y1","0%");o.setAttribute("x2","0%");o.setAttribute("y2","100%");h.appendChild(o);l.appendChild(h);f=document.createElementNS(iep.svgsn,"path");var d=k/3;var b=d*3/4;n="A"+d+" "+b+" -90 0 0 "+e+" "+String(d)+"A"+d+" "+b+" -90 0 1 "+ +e+" "+String(-d)+"A"+d+" "+b+" -90 0 0 "+ +e+" "+String(-k);q="M 0 0 L"+e+" "+k+n+"Z";f.setAttribute("d",q);f.setAttribute("style","stroke:black; stroke-width:0.5; fill: url(#gradpointe); fill-opacity: 1;");l.appendChild(f);f=document.createElementNS(iep.svgsn,"path");q="M 0 0 L "+j+" "+i+" "+j+" "+String(-i)+"Z";f.setAttribute("d",q);f.setAttribute("style","stroke:black; stroke-width:0.5; fill: black; fill-opacity: 1;");l.appendChild(f);f=document.createElementNS(iep.svgsn,"path");q="M "+e+" "+k+n+" L "+c+" "+String(-k)+" L "+c+" "+String(k)+"Z";f.setAttribute("d",q);f.setAttribute("style","stroke:black; stroke-width:0.5; fill: url(#gradcorps); fill-opacity: 1;");l.appendChild(f);a=document.createElementNS(iep.svgsn,"circle");a.setAttribute("r",k);a.setAttribute("cx",c);a.setAttribute("cy",0);a.setAttribute("style","stroke:blue; stroke-width:0.5; fill: blue; fill-opacity: 1;");l.appendChild(a);this.g=l};iep.requerre=function(a){iep.instrumentAncetre.call(this,a);this.x=200;this.y=400;this.angle=0;this.zoomfactor=1;this.abscisse=0;this.creeg();this.g.setAttribute("visibility","hidden");this.setPosition(this.x,this.y,this.angle);a.svg.appendChild(this.g)};iep.requerre.prototype=new iep.instrumentAncetre();iep.requerre.prototype.creeg=function(){var h,b,o,l,q;var e=172;var c=256;var k=57;var j=5;var n=16;var f=20;var i=15;var m=6;var a="stroke:#999999;stroke-width:2; fill: #c6cbe8; fill-opacity: 0.5";h=document.createElementNS(iep.svgsn,"g");b=document.createElementNS(iep.svgsn,"path");o="M 0 0 L "+String(e-j)+" 0 A "+j+" "+j+" 0 0 1 "+String(e)+" "+j+" L "+String(e)+" "+String(k-j)+" A "+j+" "+j+" 90 0 1 "+String(e-j)+" "+String(k)+" L "+String(-c+j)+" "+k+" A "+j+" "+j+" 180 0 1 -"+c+" "+String(k-j)+" L "+String(-c)+" "+j+" A "+j+" "+j+" -90 0 1 "+String(-c+j)+" 0Z";var d=k-i;l="M"+String(e-f+m)+" "+d+"A "+m+" "+m+" 180 0 0 "+String(e-f-m)+" "+String(d)+"A "+m+" "+m+" 180 0 0 "+String(e-f+m)+" "+String(d);o+=l;b.setAttribute("d",o);b.setAttribute("style",a);h.appendChild(b);b=document.createElementNS(iep.svgsn,"path");o="M"+String(e)+" "+String(n)+"L"+String(e)+" "+String(k-j)+" A "+j+" "+j+" 90 0 1 "+String(e-j)+" "+String(k)+" L "+String(-c+j)+" "+k+" A "+j+" "+j+" 180 0 1 -"+c+" "+String(k-j)+" L "+String(-c)+" "+String(n)+"Z"+l;b.setAttribute("d",o);b.setAttribute("style",a);h.appendChild(b);q=document.createElementNS(iep.svgsn,"line");q.setAttribute("x1",0);q.setAttribute("y1",8);q.setAttribute("x2",0);q.setAttribute("y2",0);q.setAttribute("style","stroke: black");h.appendChild(q);this.gequerre=new iep.equerre.prototype.creeg();this.gequerre.setAttribute("transform","scale(0.7)");h.appendChild(this.gequerre);this.setAbs(this.abscisse);this.g=h};iep.requerre.prototype.setAbs=function(a){this.abscisse=a;this.gequerre.setAttribute("transform","translate("+a+",0)")};iep.requerre.prototype.lanceAnimationGlissement=function(c,a){this.absfin=c;this.pix=(c>=this.abscisse)?a/4:-a/4;this.dist=Math.abs(c-this.abscisse);var b=this;this.timer=setInterval(function(){iep.requerre.actionPourGlissement.call(b)},25)};iep.requerre.actionPourGlissement=function(){var a=this.abscisse+this.pix;var b=Math.abs(this.absfin-a);if((b>this.dist)||!this.doc.animationEnCours){this.setAbs(this.absfin);clearInterval(this.timer);this.doc.actionSuivante();return}else{this.dist=b;this.setAbs(a)}};iep.compas=function(a){iep.instrumentAncetre.call(this,a);this.ecart=0;this.bretourne=false;this.leve=false;this.lon=185;this.longpointe=18;var b=this.lon+this.longpointe;this.alp=Math.asin(this.ecart/(2*b))/Math.PI*180;this.decbh=30;this.creeg();this.g.setAttribute("visibility","hidden");this.setPosition(this.x,this.y,this.angle,1);a.svg.appendChild(this.g)};iep.compas.prototype=new iep.instrumentAncetre();iep.compas.prototype.initialisePosition=function(){iep.instrumentAncetre.prototype.initialisePosition.call(this);this.ecart=0;this.positionne()};iep.compas.prototype.creeg=function(){var u,k,o,n,l,j,a;var b=this.lon;var w=this.longpointe;var y=7;var d=20;var r=6;var q=3.5;var z=3;var s=12;var h=24;var t=35;var v=6;var i=50;var f=3;var m=70;u=document.createElementNS(iep.svgsn,"g");this.bg=document.createElementNS(iep.svgsn,"g");k=document.createElementNS(iep.svgsn,"line");k.setAttribute("x1",0);k.setAttribute("y1",0);k.setAttribute("x2",0);k.setAttribute("y2",-w);k.setAttribute("style","stroke: black; stroke-width:1.5;");this.bg.appendChild(k);o=document.createElementNS(iep.svgsn,"path");n="M0 "+String(-w)+"L 0 "+String(-w-b)+" "+String(-y)+" "+String(-w-b)+" "+String(-y)+" "+String(-w)+"Z";o.setAttribute("d",n);o.setAttribute("style","stroke:black;stroke-width:0.75; fill: silver; fill-opacity: 1");this.bg.appendChild(o);l=document.createElementNS(iep.svgsn,"circle");l.setAttribute("cx",-y/2);l.setAttribute("cy",-w-d);l.setAttribute("r",r);l.setAttribute("style","stroke:black;stroke-width:0.75; fill: silver; fill-opacity: 1");this.bg.appendChild(l);l=document.createElementNS(iep.svgsn,"circle");l.setAttribute("cx",-y/2);l.setAttribute("cy",-w-d);l.setAttribute("r",2);l.setAttribute("style","stroke:black;stroke-width:1; fill: silver; fill-opacity: 1");this.bg.appendChild(l);u.appendChild(this.bg);this.bd=document.createElementNS(iep.svgsn,"g");o=document.createElementNS(iep.svgsn,"path");n="M 0 0 L0 "+String(-w)+" "+q+" "+String(-w-q)+" "+q+" "+String(-q-3)+"Z";o.setAttribute("style","stroke:black;stroke-width:0.75; fill: blck; fill-opacity: 1");o.setAttribute("d",n);this.bd.appendChild(o);o=document.createElementNS(iep.svgsn,"path");n="M0 "+String(-w)+"L 0 "+String(-w-b)+" "+y+" "+String(-w-b)+" "+y+" "+String(-w)+"Z";o.setAttribute("d",n);o.setAttribute("style","stroke:black;stroke-width:0.75; fill: silver; fill-opacity: 1");this.bd.appendChild(o);o=document.createElementNS(iep.svgsn,"path");var e=r/4*3;var c=r/2;n="M"+y+" "+String(-w-d+e)+"A "+e+" "+c+" -90 0 0 "+y+" "+String(-w-d-e)+"Z";o.setAttribute("style","stroke:black;stroke-width:1; fill: silver; fill-opacity: 1");o.setAttribute("d",n);this.bd.appendChild(o);var x="stroke: black; stroke-width:1;";k=document.createElementNS(iep.svgsn,"line");k.setAttribute("x1",0);k.setAttribute("y1",-100);k.setAttribute("x2",y);k.setAttribute("y2",-100+y);k.setAttribute("style",x);this.bd.appendChild(k);k=document.createElementNS(iep.svgsn,"line");k.setAttribute("x1",0);k.setAttribute("y1",-50);k.setAttribute("x2",y);k.setAttribute("y2",-50);k.setAttribute("style",x);this.bd.appendChild(k);k=document.createElementNS(iep.svgsn,"line");k.setAttribute("x1",y/2);k.setAttribute("y1",-50);k.setAttribute("x2",y/2);k.setAttribute("y2",-73);k.setAttribute("style",x);this.bd.appendChild(k);a=document.createElementNS(iep.svgsn,"rect");a.setAttribute("x",y);a.setAttribute("y",-68);a.setAttribute("width",4);a.setAttribute("height",12);a.setAttribute("style","stroke:black;stroke-width:0.75; fill: silver; fill-opacity: 1");this.bd.appendChild(a);u.appendChild(this.bd);this.haut=document.createElementNS(iep.svgsn,"g");o=document.createElementNS(iep.svgsn,"path");n="M 0 0 L"+z+" 0 "+s+" "+String(-h)+" "+s+" "+String(-t)+"A"+String(i-t)+" "+String(s-v)+" -90 0 1 "+v+" "+String(-i)+"L"+f+" "+String(-m)+" "+String(-f)+" "+String(-m)+"L"+String(-v)+" "+String(-i)+"A"+String(i-t)+" "+String(s-v)+" 90 0 1 "+String(-s)+" "+String(-t)+" L "+String(-s)+" "+String(-h)+" "+String(-z)+" 0Z";o.setAttribute("d",n);o.setAttribute("style","stroke:black;stroke-width:0.75; fill: #666666; fill-opacity: 1");this.haut.appendChild(o);k=document.createElementNS(iep.svgsn,"line");k.setAttribute("x1",v);k.setAttribute("y1",-i);k.setAttribute("x2",-v);k.setAttribute("y2",-i);k.setAttribute("style","stroke: black; stroke-width:1;");this.haut.appendChild(k);j=document.createElementNS(iep.svgsn,"text");j.setAttribute("pointer-events","none");j.appendChild(document.createTextNode("Sésamath"));j.setAttribute("x",0);j.setAttribute("y",0);j.setAttribute("style","font-family: Arial;font-size: 5pt;fill: white");j.setAttribute("transform","rotate(-90) translate(4,2.5)");this.haut.appendChild(j);l=document.createElementNS(iep.svgsn,"circle");l.setAttribute("cx",-y+1);l.setAttribute("cy",-this.decbh);l.setAttribute("r",3);l.setAttribute("style","stroke:black;stroke-width:1; fill: white; fill-opacity: 1");this.haut.appendChild(l);l=document.createElementNS(iep.svgsn,"circle");l.setAttribute("cx",y-1);l.setAttribute("cy",-this.decbh);l.setAttribute("r",3);l.setAttribute("style","stroke:black;stroke-width:1; fill: white; fill-opacity: 1");this.haut.appendChild(l);u.appendChild(this.haut);this.g=u};iep.compas.prototype.setPosition=function(a,i,h,e){var c,g;if(arguments.length>=4){c=e;this.zoomfactor=c}else{c=this.zoomfactor}if(this.bretroune){g="scale("+c+","+String(-c)+") "}else{g="scale("+c+") "}this.x=a;this.y=i;this.angle=h;var f=this.lon+this.longpointe;this.alp=Math.asin(this.ecart/(2*f*c))/Math.PI*180;this.bg.setAttribute("transform","rotate("+this.alp+")");this.bd.setAttribute("transform","translate("+this.ecart/c+",0) rotate("+String(-this.alp)+")");var b=this.alp/180*Math.PI;this.haut.setAttribute("transform","translate("+String(this.ecart/2/c)+","+String((-f)*Math.cos(b)+this.decbh)+")");this.g.setAttribute("transform",g+"translate("+String(a/c)+","+String(i/c)+") rotate("+h+")")};iep.compas.prototype.retourne=function(){this.bretourne=!this.bretourne;this.setPosition(this.x,this.y,this.angle)};iep.compas.prototype.positionne=function(){iep.instrumentAncetre.prototype.positionne.call(this);if(this.leve&&(this.doc.compasLeve!=null)){iep.instrumentAncetre.prototype.positionne.call(this.doc.compasLeve)}};iep.compas.prototype.translate=function(a,b){iep.instrumentAncetre.prototype.translate.call(this,a,b);if(this.leve&&(this.doc.compasLeve!=null)){iep.instrumentAncetre.prototype.translate.call(this.doc.compasLeve,a,b)}};iep.compas.prototype.lanceAnimationEcartement=function(d,c){this.ecartfin=parseFloat(d);this.pasecart=c/4;var b=(d>=this.ecart)?1:-1;this.pasecart*=b;this.distecart=Math.abs(d-this.ecart);var a=this;this.timer=setInterval(function(){iep.compas.actionPourEcartement.call(a)},25)};iep.compas.actionPourEcartement=function(){var b=this.ecart+this.pasecart;var a=Math.abs(b-this.ecartfin);if((a>this.distecart)||!this.doc.animationEnCours){this.ecart=this.ecartfin;this.setPosition(this.x,this.y,this.angle);clearInterval(this.timer);this.doc.actionSuivante();return}else{this.distecart=a;this.ecart=b;this.setPosition(this.x,this.y,this.angle)}};iep.compasLeve=function(c,a,f,d,e){iep.instrumentAncetre.call(this,c);var b=(c.compasLeve==null)?null:c.compasLeve.g;this.x=a;this.y=f;this.angle=d;this.ecart=e;this.creeg();this.g.setAttribute("visibility","hidden");this.setPosition(a,f,d);if(b==null){c.svg.appendChild(this.g)}else{c.svg.replaceChild(this.g,b)}};iep.compasLeve.prototype=new iep.instrumentAncetre();iep.compasLeve.prototype.creeg=function(){var n,q,b,a;var s=7;var c=8;var o=this.ecart;var i=document.createElementNS(iep.svgsn,"g");if(this.ecart>2*c){n=document.createElementNS(iep.svgsn,"rect");n.setAttribute("x",c);n.setAttribute("y",-s/2);n.setAttribute("width",this.ecart-2*c);n.setAttribute("height",s);n.setAttribute("rx",1);n.setAttribute("ry",1);n.setAttribute("style","stroke:black;stroke-width:0.5;fill:silver;fill-opacity:1");i.appendChild(n)}b=document.createElementNS(iep.svgsn,"path");b.setAttribute("d","M0 0 L"+c+" 1 "+c+" -1Z");b.setAttribute("style","stroke:black;stroke-width:0.5;fill:black;fill-opacity:1");i.appendChild(b);var l=o-2*c;q=document.createElementNS(iep.svgsn,"line");q.setAttribute("x1",c);q.setAttribute("y1",0);q.setAttribute("x2",c+l/8);q.setAttribute("y2",0);q.setAttribute("style","stroke: black; stroke-width:0.5;");i.appendChild(q);b=document.createElementNS(iep.svgsn,"path");var k=String(o-c);b.setAttribute("d","M"+o+" 0 L"+k+" 1.5 "+k+" -1.5Z");b.setAttribute("style","stroke:black;stroke-width:0.5;fill:black;fill-opacity:1");i.appendChild(b);q=document.createElementNS(iep.svgsn,"line");q.setAttribute("x1",k);q.setAttribute("y1",0);q.setAttribute("x2",String(o-c-l/8));q.setAttribute("y2",0);q.setAttribute("style","stroke: black; stroke-width:0.5;");i.appendChild(q);q=document.createElementNS(iep.svgsn,"line");var j=String(o-c-l/8-2);q.setAttribute("x1",j);q.setAttribute("y1",-s/2);q.setAttribute("x2",j);q.setAttribute("y2",s/2);q.setAttribute("style","stroke: black; stroke-width:0.5;");i.appendChild(q);q=document.createElementNS(iep.svgsn,"line");j=String(o-c-l/3-2);q.setAttribute("x1",j);q.setAttribute("y1",-s/2);q.setAttribute("x2",j);q.setAttribute("y2",s/2);q.setAttribute("style","stroke: black; stroke-width:0.5;");i.appendChild(q);n=document.createElementNS(iep.svgsn,"rect");n.setAttribute("x",String(c+l/8-5));n.setAttribute("y",String(-s));n.setAttribute("width",8);n.setAttribute("height",3);n.setAttribute("style","stroke:black;stroke-width:0.75; fill: silver; fill-opacity: 1");i.appendChild(n);n=document.createElementNS(iep.svgsn,"rect");n.setAttribute("x",String(o-c-l/8-4));n.setAttribute("y",String(-s));n.setAttribute("width",8);n.setAttribute("height",3);n.setAttribute("style","stroke:black;stroke-width:0.75; fill: silver; fill-opacity: 1");i.appendChild(n);var h=12;var m=4;b=document.createElementNS(iep.svgsn,"path");var r="M"+String(o/2+h)+" "+String(-m)+" A "+String(h)+" 2 180 0 0 "+String(o/2-h)+" "+String(-m)+"A"+String(m)+" 2 90 0 1 "+String(o/2-h)+" "+String(m)+"A"+String(h)+" 2 0 0 0 "+String(o/2+h)+" "+String(m)+"A"+String(m)+" 2 -90 0 1 "+String(o/2+h)+" "+String(-m);b.setAttribute("d",r);b.setAttribute("style","stroke:black;stroke-width:0.75; fill: #666666; fill-opacity: 1");i.appendChild(b);q=document.createElementNS(iep.svgsn,"line");q.setAttribute("x1",String(o/2+h));q.setAttribute("y1",-s/2);q.setAttribute("x2",String(o/2-h));q.setAttribute("y2",s/2);q.setAttribute("style","stroke: black; stroke-width:0.5;");i.appendChild(q);q=document.createElementNS(iep.svgsn,"line");q.setAttribute("x1",String(o/2-h));q.setAttribute("y1",-s/2);q.setAttribute("x2",String(o/2+h));q.setAttribute("y2",s/2);q.setAttribute("style","stroke: black; stroke-width:0.5;");i.appendChild(q);a=document.createElementNS(iep.svgsn,"circle");a.setAttribute("cx",String(o/2));a.setAttribute("cy",0);a.setAttribute("r",5);a.setAttribute("style","stroke:black;stroke-width:0.75; fill: #666666; fill-opacity: 1");i.appendChild(a);n=document.createElementNS(iep.svgsn,"rect");n.setAttribute("x",String(c+l/8-5));n.setAttribute("y",String(-s));n.setAttribute("width",7);n.setAttribute("height",3);n.setAttribute("style","stroke:black;stroke-width:0.75; fill: silver; fill-opacity: 1");i.appendChild(n);n=document.createElementNS(iep.svgsn,"rect");n.setAttribute("x",String(o-c-l/8-4));n.setAttribute("y",String(-s));n.setAttribute("width",7);n.setAttribute("height",3);n.setAttribute("style","stroke:black;stroke-width:0.75; fill: silver; fill-opacity: 1");i.appendChild(n);this.g=i};iep.compasLeve.prototype.setPosition=function(a,c,b){this.x=a;this.y=c;this.angle=b;this.g.setAttribute("transform","translate("+a+","+c+") rotate("+b+")")};iep.objetBase=function(b,c,a){this.doc=b;this.id=c;this.couleur=a;this.zoomfactor=1;this.visible=false;this.objet="trait"};iep.objetBase.prototype.positionne=function(){};iep.objetBase.prototype.initialisePosition=function(){};iep.objetBase.prototype.translate=function(d,c){this.setPosition(d,c,this.angle,this.zoomfactor)};iep.objetBase.prototype.tourne=function(a){this.setPosition(this.x,this.y,a,this.zoomfactor)};iep.objetBase.prototype.zoom=function(a){this.zoomfactor=a;this.setPosition(this.x,this.y,this.angle,a)};iep.objetBase.prototype.montre=function(a){this.visible=a;this.g.setAttribute("visibility",a?"visible":"hidden")};iep.objetBase.prototype.lanceAnimationTranslation=function(b,e,c){this.xfin=b;this.yfin=e;this.pix=Math.abs(c/4);var a=new iep.vect(this.x,this.y,b,e);this.dist=a.norme();if(this.dist===0){this.translate(this.xfin,this.yfin);this.doc.actionSuivante();return}this.vect=a.vecteurColineaire(this.pix);var d=this;this.timer=setInterval(function(){iep.objetBase.actionPourTranslation.call(d)},25)};iep.objetBase.actionPourTranslation=function(){var a=this.x+this.vect.x;var e=this.y+this.vect.y;var b=new iep.vect(a,e,this.xfin,this.yfin);var c=b.norme();if((c>this.dist)||!this.doc.animationEnCours){this.translate(this.xfin,this.yfin);clearInterval(this.timer);this.doc.actionSuivante();return}else{this.dist=c;this.translate(a,e)}};iep.objetBase.prototype.lanceAnimationRotation=function(b,a){this.anglefin=b;this.pasdeg=a*2/3;var d=(b>=this.angle)?1:-1;this.pasdeg*=d;this.distang=Math.abs(b-this.angle);var c=this;this.timer=setInterval(function(){iep.objetBase.actionPourRotation.call(c)},25)};iep.objetBase.actionPourRotation=function(){var b=parseFloat(this.angle)+parseFloat(this.pasdeg);var a=Math.abs(b-this.anglefin);if((a>this.distang)||!this.doc.animationEnCours){this.tourne(this.anglefin);clearInterval(this.timer);this.doc.actionSuivante();return}else{this.distang=a;this.tourne(b)}};iep.objetBase.prototype.lanceAnimationZoom=function(a,c){this.zoomfin=a;this.vitesse=parseInt(c);this.pas=this.vitesse*0.05*(this.zoomfin-this.zoomfactor);this.senspos=(this.pas>=0);var b=this;this.timer=setInterval(function(){iep.objetBase.actionPourZoom.call(b)},100)};iep.objetBase.actionPourZoom=function(){var a=this.zoomfactor+this.pas;if(this.doc.animationEnCours&&((this.senspos&&(a<this.zoomfin))||(!this.senspos&&(a>this.zoomfin)))){this.zoom(a)}else{this.zoom(this.zoomfin);clearInterval(this.timer);this.doc.actionSuivante();return}};iep.objetBase.prototype.updateg=function(){var a=this.g;this.creeg();this.doc.svg.replaceChild(this.g,a);this.doc.setElement(this.id,this);this.g.setAttribute("visibility","visible")};iep.objetBase.prototype.creationAnimee=function(){return false};iep.objetBase.prototype.finAction=function(){};iep.objetLigne=function(c,g,a,f,b,e){iep.objetBase.call(this,c,g,a);this.epaisseur=f;this.opacite=(arguments.length>=5)?b:"100";this.styleTrait=(arguments.length>=6)?e:"continu";var d=parseFloat(this.opacite/100);this.style="stroke:"+a+";stroke-width:"+f+";stroke-opacity:"+d+";stroke-linecap:round;";if(this.styleTrait==="tiret"){this.style+="stroke-dasharray:3 3;"}};iep.objetLigne.prototype=new iep.objetBase();iep.droiteAncetre=function(i,b,c,h,a,f,g,e,d,j){this.x1=parseFloat(c);this.y1=parseFloat(h);this.x2=parseFloat(a);this.y2=parseFloat(f);iep.objetLigne.call(this,i,b,g,e,d,j)};iep.droiteAncetre.prototype=new iep.objetLigne();iep.droiteAncetre.prototype.creeg=function(){var b,a;b=document.createElementNS(iep.svgsn,"g");a=document.createElementNS(iep.svgsn,"line");a.setAttribute("x1",this.x1);a.setAttribute("y1",this.y1);a.setAttribute("x2",this.x2);a.setAttribute("y2",this.y2);a.setAttribute("style",this.style);b.appendChild(a);b.setAttribute("visibility","hidden");b.setAttribute("id",this.id);this.g=b};iep.droiteAncetre.prototype.creationAnimee=function(){return true};iep.droiteAncetre.prototype.lanceAnimation=function(d){this.vitesse=d/4;var b=new iep.vect(this.x1,this.y1,this.x2,this.y2);this.dist=b.norme();if(iep.zero(this.dist)){this.doc.actionSuivante();return}this.vect=b.vecteurColineaire(this.vitesse*1.8);this.xfin=this.x2;this.yfin=this.y2;this.x2=this.x1;this.y2=this.y1;var a=this.doc.crayon;a.setPosition(this.x1,this.y1,a.angle);var c=this;this.timer=setInterval(function(){iep.droiteAncetre.actionPourAnimation.call(c)},25)};iep.droiteAncetre.actionPourAnimation=function(){this.x2+=this.vect.x;this.y2+=this.vect.y;var b=new iep.vect(this.x1,this.y1,this.x2,this.y2);var c=b.norme();var a=this.doc.crayon;if((c>this.dist)||!this.doc.animationEnCours){this.x2=this.xfin;this.y2=this.yfin;this.finAction();this.updateg();clearInterval(this.timer);this.doc.actionSuivante();return}else{a.translate(this.x2,this.y2);this.updateg()}};iep.droiteAncetre.prototype.finAction=function(){this.doc.crayon.translate(this.x2,this.y2)};iep.point=function(c,f,b,e,a,d){this.x=parseFloat(b);this.y=parseFloat(e);this.xinit=this.x;this.yinit=this.y;this.xcons=this.x;this.ycons=this.y;iep.objetLigne.call(this,c,f,a,d);this.style+="stroke-linecap:round;";this.nom=null;this.objet="point"};iep.point.prototype=new iep.objetLigne();iep.point.prototype.initialisePosition=function(){this.x=this.xinit;this.y=this.yinit;this.positionne()};iep.point.prototype.creeg=function(){var b,a;var c=5;b=document.createElementNS(iep.svgsn,"g");a=document.createElementNS(iep.svgsn,"line");a.setAttribute("x1",-c);a.setAttribute("y1",c);a.setAttribute("x2",c);a.setAttribute("y2",-c);a.setAttribute("style",this.style);b.appendChild(a);a=document.createElementNS(iep.svgsn,"line");a.setAttribute("x1",-c);a.setAttribute("y1",-c);a.setAttribute("x2",c);a.setAttribute("y2",c);a.setAttribute("style",this.style);b.appendChild(a);b.setAttribute("id",this.id);this.g=b};iep.point.prototype.positionne=function(){this.g.setAttribute("transform","translate("+this.x+","+this.y+")")};iep.point.prototype.translate=function(a,b){this.x=a;this.y=b;this.positionne();if(this.nom!==null){this.nom.positionne()}};iep.point.prototype.updateg=function(){this.setPosition(this.x,this.y)};iep.point.prototype.montre=function(a){iep.objetBase.prototype.montre.call(this,a);if(this.nom!==null){if(this.nom.g){this.nom.montre(a)}}};iep.segment=function(i,b,c,h,a,f,g,e,d,j,k){iep.droiteAncetre.call(this,i,b,c,h,a,f,g,e,d,j);this.stylefleche=k};iep.segment.prototype=new iep.droiteAncetre();iep.segment.prototype.creeg=function(){iep.droiteAncetre.prototype.creeg.call(this);if(this.stylefleche==="vecteur"){var j;var h=12;var e=this.x1;var c=this.x2;var l=this.y1;var k=this.y2;var i=new iep.vect(c,k,e,l);var f=i.vecteurColineaire(h);var d=new iep.vect(f.x*iep.cos30-f.y*iep.sin30,f.x*iep.sin30+f.y*iep.cos30);var b=new iep.vect(f.x*iep.cos30+f.y*iep.sin30,-f.x*iep.sin30+f.y*iep.cos30);var m=String(c+d.x)+" "+String(k+d.y)+","+c+" "+k+","+String(c+b.x)+" "+String(k+b.y);j=document.createElementNS(iep.svgsn,"polyline");j.setAttribute("points",m);var a="stroke:"+this.couleur+";stroke-width:"+this.epaisseur+";stroke-opacity:"+this.opacite+";fill:none";j.setAttribute("style",a);this.g.appendChild(j)}};iep.droite=function(i,b,c,h,a,f,g,e,d,j){iep.droiteAncetre.call(this,i,b,c,h,a,f,g,e,d,j)};iep.droite.prototype=new iep.droiteAncetre();iep.droite.prototype.creeg=function(){var b,a;this.calcule();if(!this.horsFenetre){a=document.createElementNS(iep.svgsn,"line");a.setAttribute("x1",this.xext1);a.setAttribute("y1",this.yext1);a.setAttribute("x2",this.xext2);a.setAttribute("y2",this.yext2);a.setAttribute("style",this.style);this.g=a}else{this.g=document.createElementNS(iep.svgsn,"g")}this.g.setAttribute("visibility","hidden");this.g.setAttribute("id",this.id)};iep.droite.prototype.calcule=function(){var m,b,j,q,i,p,h,o,g,e,l,c,k;var d=parseInt(this.doc.svg.getAttribute("width"));var n=parseInt(this.doc.svg.getAttribute("height"));e=this.x1;l=this.y1;c=this.x2;k=this.y2;if((e===c)&&(l===k)){this.horsFenetre=true;return}this.horsFenetre=false;if(e===c){this.xext1=e;this.yext1=0;this.xext2=e;this.yext2=n;if((e<0)||(e>d)){this.horsFenetre=true;return}this.xext1=e;this.yext1=0;this.xext2=e;this.yext2=n;return}if(l===k){this.xext1=0;this.yext1=l;this.xext2=d;this.yext2=l;if((l<0)||(l>n)){this.horsFenetre=true;return}this.xext1=0;this.yext1=l;this.xext2=d;this.yext2=l;return}var f=0;m=(k-l)/(c-e);b=0;j=this.y1+m*(b-e);if((j>=0)&&(j<=n)){f++;this.xext1=b;this.yext1=j}q=d;i=m*(q-e)+l;if((i>=0)&&(i<=n)){f++;if(f===1){this.xext1=q;this.yext1=i}else{this.xext2=q;this.yext2=i;return}}h=0;p=(h-l)/m+e;if((p>0)&&(p<d)){f++;if(f===1){this.xext1=p;this.yext1=h}else{this.xext2=p;this.yext2=h;return}}g=n;o=(g-l)/m+e;if((o>0)&&(o<=d)){f++;if(f===2){this.xext2=o;this.yext2=g}else{this.horsFenetre=true}}else{this.horsFenetre=true}if(this.horsFenetre){this.xext1=0;this.yext1=j;this.xext2=q;this.yext2=i}};iep.demiDroite=function(i,b,c,h,a,f,g,e,d,j){iep.droite.call(this,i,b,c,h,a,f,g,e,d,j)};iep.demiDroite.prototype=new iep.droite();iep.demiDroite.prototype.calcule=function(){var b,a;iep.droite.prototype.calcule.call(this);var c=new iep.vect(this.x1,this.y1,this.x2,this.y2);if(this.horsFenetre){return}b=new iep.vect(this.x1,this.y1,this.xext1,this.yext1);if(b.presqueNul()){a=new iep.vect(this.x1,this.y1,this.xext2,this.yext2);if(iep.colineairesMemeSens(a,c)){this.xext1=this.x1;this.yext1=this.y1}else{this.xext2=this.xext1;this.yext2=this.yext1;this.xext1=this.x1;this.yext1=this.y1}}else{if(iep.colineairesMemeSens(b,c)){this.xext2=this.xext1;this.yext2=this.yext1;this.xext1=this.x1;this.yext1=this.y1}else{this.xext1=this.x1;this.yext1=this.y1}}};iep.ligneContinue=function(h,b,a,g,j,c,f,e,d,i){iep.objetLigne.call(this,h,b,f,e,d,i);this.xdeb=a;this.ydeb=g;this.abs=j.split(",");this.ord=c.split(",");this.objet="trait"};iep.ligneContinue.prototype=new iep.objetLigne();iep.ligneContinue.prototype.creeg=function(){var c,b,a;c=document.createElementNS(iep.svgsn,"polyline");b=this.xdeb+" "+this.ydeb;for(a=0;a<this.abs.length;a++){b+=" "+this.abs[a]+" "+this.ord[a]}c.setAttribute("points",b);c.setAttribute("style",this.style+"fill:none;");c.setAttribute("visibility","hidden");c.setAttribute("id",this.id);this.g=c};iep.ligneContinue.prototype.creationAnimee=function(){return true};iep.ligneContinue.prototype.lanceAnimation=function(){this.sauveabs=this.abs;this.sauveord=this.ord;this.abs=[];this.ord=[];this.ind=-1;var a=this;this.timer=setInterval(function(){iep.ligneContinue.actionPourAnimation.call(a)},25)};iep.ligneContinue.actionPourAnimation=function(){this.ind++;var b=this.doc.crayon;if(this.ind>=this.sauveabs.length){this.abs=this.sauveabs;this.ord=this.sauveord;this.updateg();clearInterval(this.timer);this.finAction();this.doc.actionSuivante();return}else{var a=this.sauveabs[this.ind];var c=this.sauveord[this.ind];this.abs.push(a);this.ord.push(c);this.updateg();b.setPosition(parseFloat(a),parseFloat(c),b.angle);this.updateg()}};iep.ligneContinue.prototype.finAction=function(){var a=this.abs.length;this.doc.crayon.translate(parseFloat(this.abs[a-1]),parseFloat(this.ord[a-1]))};iep.polygone=function(g,a,i,b,f,e,h,c){iep.objetBase.call(this,g,a,f);this.abs=i.split(",");this.ord=b.split(",");this.sauveabs=this.abs;this.sauveord=this.ord;this.epaisseur=e;this.opacite=(c==null)?"60":c;var d=parseFloat(this.opacite/100);if(h==null){this.couleurFond=this.couleur}else{this.couleurFond=h}this.style="stroke:"+f+";stroke-width:"+e+";fill:"+this.couleurFond+";";this.style+="fill-opacity:"+d+";";this.objet="trait"};iep.polygone.prototype=new iep.objetBase();iep.polygone.prototype.creeg=function(){var c,b,a;c=document.createElementNS(iep.svgsn,"polygon");b="";for(a=0;a<this.abs.length;a++){b+=" "+this.abs[a]+" "+this.ord[a]}c.setAttribute("points",b);c.setAttribute("style",this.style);c.setAttribute("visibility","hidden");c.setAttribute("id",this.id);this.g=c};iep.polygone.prototype.creationAnimee=function(){return true};iep.polygone.prototype.lanceAnimation=function(d){this.pix=parseFloat(d/2);this.abs=[];this.abs[0]=this.sauveabs[0];this.ord=[];this.ord[0]=this.sauveord[0];this.ind=0;this.n=0;var a=this.doc.crayon;var b=new iep.vect(parseFloat(this.sauveabs[0]),parseFloat(this.sauveord[0]),parseFloat(this.sauveabs[1]),parseFloat(this.sauveord[1]));this.longcote=b.norme();this.vect=b.vecteurColineaire(this.pix);a.setPosition(parseFloat(this.abs[0]),parseFloat(this.ord[0]),a.angle);var c=this;this.timer=setInterval(function(){iep.polygone.actionPourAnimation.call(c)},25)};iep.polygone.actionPourAnimation=function(){var b=this.doc.crayon;var f=this.ind;var a=parseFloat(this.abs[f]);var g=parseFloat(this.ord[f]);this.n++;if(this.doc.animationEnCours){if(this.n*this.pix<=this.longcote){var d=a+this.n*this.vect.x;var e=g+this.n*this.vect.y;this.abs[f+1]=String(d);this.ord[f+1]=String(e);b.translate(d,e);this.updateg()}else{this.ind++;f++;if(f===this.sauveabs.length){clearInterval(this.timer);this.finAction();this.doc.actionSuivante()}else{this.abs[f]=this.sauveabs[f];this.ord[f]=this.sauveord[f];b.translate(parseFloat(this.abs[f]),parseFloat(this.ord[f]));var c=new iep.vect(parseFloat(this.sauveabs[f]),parseFloat(this.sauveord[f]),parseFloat(this.sauveabs[f+1]),parseFloat(this.sauveord[f+1]));this.longcote=c.norme();this.vect=c.vecteurColineaire(this.pix);this.n=0}}}else{clearInterval(this.timer);this.finAction();this.doc.actionSuivante()}};iep.polygone.prototype.finAction=function(){this.abs=this.sauveabs;this.ord=this.sauveord;var a=this.abs.length;this.updateg();this.doc.crayon.translate(parseFloat(this.abs[a-1]),parseFloat(this.ord[a-1]))};iep.angle=function(k,a,i,f,h,d,c,g,e,b,j){this.x=parseFloat(i);this.y=parseFloat(f);this.ray=parseFloat(h);this.ang1=parseFloat(d);this.ang2=parseFloat(c);this.motif=(j==null)?"simple":j;iep.objetLigne.call(this,k,a,g,e,1);this.opaciteRemplissage=(b==null)?0.7:parseFloat(b)/100;this.objet="angle"};iep.angle.prototype=new iep.objetLigne();iep.angle.prototype.creeg=function(){var s;var E;var a=5;var U=this.motif;var N=this.ray;var K=this.ang1;var H=this.ang2;var S=H-K;var B=iep.mesurePrincDeg(S);if(iep.zeroAngle(Math.abs(S)-180)){s=(this.ang1<=this.ang2)}else{s=B>0}var o=(new iep.vect(this.x,this.y,this.x+Math.cos(K*iep.convDegRad),this.y+Math.sin(K*iep.convDegRad))).vecteurColineaire(N);var m=(new iep.vect(this.x,this.y,this.x+Math.cos(H*iep.convDegRad),this.y+Math.sin(H*iep.convDegRad))).vecteurColineaire(N);var C=this.x+o.x;var t=this.y+o.y;var z=this.x+m.x;var q=this.y+m.y;var P=document.createElementNS(iep.svgsn,"g");var I=document.createElementNS(iep.svgsn,"path");var w=(U.indexOf("plein")!==-1)?this.couleur:"none";if(w!=="none"){E="M"+this.x+" "+this.y+"L"+C+" "+t+"A"+N+" "+N+" "+this.ang1+" 0 "+(s?"1 ":"0 ")+z+" "+q+" Z"}else{E="M"+C+" "+t+"A"+N+" "+N+" "+this.ang1+" 0 "+(s?"1 ":"0 ")+z+" "+q}I.setAttribute("d",E);var l="stroke:"+this.couleur+";stroke-width:"+this.epaisseur+";";var L=l+"fill:"+w+";fill-opacity:"+this.opaciteRemplissage+";";I.setAttribute("style",L);P.appendChild(I);var V=(U.indexOf("O")!==-1);var A=o.tourne(B/2);var D=this.x+A.x;var u=this.y+A.y;if(V){var f=document.createElementNS(iep.svgsn,"circle");f.setAttribute("r",5);f.setAttribute("cx",D);f.setAttribute("cy",u);f.setAttribute("style",l+"fill:none;");P.appendChild(f)}var M=(U.indexOf("triple")!==-1)?2:((U.indexOf("double")!==-1)?1:0);for(var O=1;O<=M;O++){I=document.createElementNS(iep.svgsn,"path");var F=N-O*5;var k=o.vecteurColineaire(F);var h=m.vecteurColineaire(F);C=this.x+k.x;t=this.y+k.y;z=this.x+h.x;q=this.y+h.y;E="M"+C+" "+t+"A"+F+" "+F+" "+this.ang1+" 0 "+(s?"1 ":"0 ")+z+" "+q;I.setAttribute("d",E);I.setAttribute("style",l+"fill:none;");P.appendChild(I)}var b=(U.indexOf("///")!==-1)?3:((U.indexOf("//")!==-1)?2:((U.indexOf("/")!==-1)?1:0));if(b===0){this.g=P;return}var x=M+1;var y=A.vecteurColineaire(1);switch(b){case 1:var J=this.x+y.x*N;var G=this.y+y.y*N;var e=document.createElementNS(iep.svgsn,"line");e.setAttribute("x1",J-y.x*a*x);e.setAttribute("y1",G-y.y*a*x);e.setAttribute("x2",J+y.x*a);e.setAttribute("y2",G+y.y*a);e.setAttribute("style",L);P.appendChild(e);break;case 2:var R=B/6;var Q=6;if(Math.abs(R)>=Math.abs(Q)){R=Q}var T=y.tourne(R);var j=this.x+T.x*N;var c=this.y+T.y*N;e=document.createElementNS(iep.svgsn,"line");e.setAttribute("x1",j-y.x*a*x);e.setAttribute("y1",c-y.y*a*x);e.setAttribute("x2",j+y.x*a);e.setAttribute("y2",c+y.y*a);e.setAttribute("style",L);P.appendChild(e);T=y.tourne(-R);j=this.x+T.x*N;c=this.y+T.y*N;e=document.createElementNS(iep.svgsn,"line");e.setAttribute("x1",j-y.x*a*x);e.setAttribute("y1",c-y.y*a*x);e.setAttribute("x2",j+y.x*a);e.setAttribute("y2",c+y.y*a);e.setAttribute("style",L);P.appendChild(e);break;case 3:J=this.x+y.x*N;G=this.y+y.y*N;e=document.createElementNS(iep.svgsn,"line");e.setAttribute("x1",J-y.x*a*x);e.setAttribute("y1",G-y.y*a*x);e.setAttribute("x2",J+y.x*a);e.setAttribute("y2",G+y.y*a);e.setAttribute("style",L);P.appendChild(e);R=B/4;Q=9;if(Math.abs(R)>=Math.abs(Q)){R=Q}T=y.tourne(R);j=this.x+T.x*N;c=this.y+T.y*N;e=document.createElementNS(iep.svgsn,"line");e.setAttribute("x1",j-y.x*a*x);e.setAttribute("y1",c-y.y*a*x);e.setAttribute("x2",j+y.x*a);e.setAttribute("y2",c+y.y*a);e.setAttribute("style",L);P.appendChild(e);T=y.tourne(-R);j=this.x+T.x*N;c=this.y+T.y*N;e=document.createElementNS(iep.svgsn,"line");e.setAttribute("x1",j-y.x*a*x);e.setAttribute("y1",c-y.y*a*x);e.setAttribute("x2",j+y.x*a);e.setAttribute("y2",c+y.y*a);e.setAttribute("style",L);P.appendChild(e);break}this.g=P};iep.angleDroit=function(f,h,d,e,c,b,a,g){this.xsommet=parseFloat(d);this.ysommet=parseFloat(e);this.xinter=parseFloat(c);this.yinter=parseFloat(b);iep.objetLigne.call(this,f,h,a,g,100);this.objet="angle_droit"};iep.angleDroit.prototype=new iep.objetLigne();iep.angleDroit.prototype.creeg=function(){var e=new iep.vect(this.xsommet,this.ysommet,this.xinter,this.yinter);var d=e.norme();e=e.vecteurColineaire(d/Math.sqrt(2));e=e.tourne(45);var c=e.tourne(-90);var b=document.createElementNS(iep.svgsn,"polyline");var a=String(this.xsommet+e.x)+" "+String(this.ysommet+e.y)+" "+this.xsommet+" "+this.ysommet+" "+String(this.xsommet+c.x)+" "+String(this.ysommet+c.y);b.setAttribute("points",a);b.setAttribute("style",this.style+"fill:none;");this.g=b};iep.arc=function(i,a,h,e,g,c,k,f,d,b,j){this.x=parseFloat(h);this.y=parseFloat(e);this.ray=parseFloat(g);this.debut=parseFloat(c);this.fin=parseFloat(k);iep.objetLigne.call(this,i,a,f,d,b,j)};iep.arc.prototype=new iep.objetLigne();iep.arc.prototype.creeg=function(){var h=this.debut;var o=this.fin;var n=this.ray;var k=(h<o)?"1":"0";var m=Math.abs(o-h);var i=document.createElementNS(iep.svgsn,"g");if(m>=359.9){var b=document.createElementNS(iep.svgsn,"circle");b.setAttribute("r",n);b.setAttribute("cx",0);b.setAttribute("cy",0);b.setAttribute("style",this.style+";fill:none;");i.appendChild(b)}else{var d=document.createElementNS(iep.svgsn,"path");var e=new iep.vect(Math.cos(h*iep.convDegRad)*n,Math.sin(h*iep.convDegRad)*n);var c=new iep.vect(Math.cos(o*iep.convDegRad)*n,Math.sin(o*iep.convDegRad)*n);var a=e.x;var l=e.y;var j=c.x;var f=c.y;var q="M"+a+" "+l+"A"+n+" "+n+" "+h+" "+((m>180)?"1":"0")+" "+k+" "+j+" "+f;d.setAttribute("d",q);d.setAttribute("style",this.style+";fill:none");i.appendChild(d)}i.setAttribute("transform","translate("+this.x+","+this.y+")");i.setAttribute("id",this.id);i.setAttribute("visibility","hidden");this.g=i};iep.arc.prototype.creationAnimee=function(){return true};iep.arc.prototype.lanceAnimation=function(e){var d=this.doc.compas;if(this.doc.compasLeve==null){this.doc.compasLeve=new iep.compasLeve(this.doc,d.x,d.y,d.angle,d.ecart)}var a=this.doc.compasLeve;this.ray=this.doc.compas.ecart;this.angfin=this.fin;this.pasdeg=e/2;var c=(this.fin>=this.debut)?1:-1;this.pasdeg*=c;this.distang=Math.abs(this.fin-this.debut);this.fin=this.debut;d.setPosition(this.x,this.y,this.debut);a.setPosition(this.x,this.y,this.debut);var b=this;this.timer=setInterval(function(){iep.arc.actionPourAnimation.call(b)},25)};iep.arc.actionPourAnimation=function(){var c=this.doc.compas;var b=this.doc.compasLeve;this.fin+=this.pasdeg;var a=Math.abs(this.angfin-this.fin);if((a>this.distang)||!this.doc.animationEnCours){this.fin=this.angfin;this.updateg();this.finAction();clearInterval(this.timer);this.doc.actionSuivante();return}else{this.distang=a;this.updateg();c.setPosition(this.x,this.y,this.fin);if(b!==null){b.setPosition(this.x,this.y,this.fin)}}};iep.arc.prototype.finAction=function(){this.doc.compas.setPosition(this.x,this.y,this.fin);if(this.doc.compasLeve!==null){this.doc.compasLeve.setPosition(this.x,this.y,this.fin)}};iep.image=function(b,c,a){this.doc=b;this.id=c;this.url=a;this.x=0;this.y=0;this.angle=0;this.objet="image";this.zoomfactor=1};iep.image.prototype=new iep.objetBase();iep.image.prototype.initialisePosition=function(){this.x=0;this.y=0;this.angle=0;this.zoomfactor=1;this.positionne()};iep.image.prototype.prepareAction=function(){var a=new Image();a.owner=this;this.action=new iep.actionCreation(this.doc,this.id,this);this.action.isReady=false;this.doc.ajouteAction(this.action);a.onload=function(){var b=this.owner;b.width=this.width;b.height=this.height;b.action.isReady=true;b.doc.waitForReadyState()};a.src=this.url};iep.image.prototype.creeg=function(a){var b=document.createElementNS(iep.svgsn,"image");b.setAttribute("width",this.width);b.setAttribute("height",this.height);b.setAttributeNS("http://www.w3.org/1999/xlink","href",this.url);b.setAttribute("x",this.x);b.setAttribute("y",this.y);b.setAttribute("visibility","hidden");this.g=b;this.setPosition(this.x,this.y,this.angle,this.zoomfactor);this.doc.svg.appendChild(b)};iep.image.prototype.setPosition=function(a,d,c,b){this.x=a;this.y=d;this.angle=c;this.zoomfactor=b;this.g.setAttribute("transform","scale("+b+") translate("+String(a/b)+","+String(d/b)+") rotate("+c+")")};iep.image.prototype.positionne=function(){this.setPosition(this.x,this.y,this.angle,this.zoomfactor)};iep.marqueSegment=function(d,g,b,f,a,e,c){this.x=parseFloat(b);this.y=parseFloat(f);this.motif=c;iep.objetLigne.call(this,d,g,a,e,100);this.objet="longueur"};iep.marqueSegment.prototype=new iep.objetLigne();iep.marqueSegment.prototype.creeg=function(){var e,a,c;var f=5;var d=5;var h=d/2;var b=5;switch(this.motif){case"/":e=document.createElementNS(iep.svgsn,"line");e.setAttribute("x1",f);e.setAttribute("y1",-f);e.setAttribute("x2",-f);e.setAttribute("y2",f);e.setAttribute("style",this.style);break;case"\\":e=document.createElementNS(iep.svgsn,"line");e.setAttribute("x1",-f);e.setAttribute("y1",-f);e.setAttribute("x2",f);e.setAttribute("y2",f);e.setAttribute("style",this.style);break;case"//":e=document.createElementNS(iep.svgsn,"g");for(c=-1;c<=1;c+=2){a=document.createElementNS(iep.svgsn,"line");a.setAttribute("x1",c*h+f);a.setAttribute("y1",-f);a.setAttribute("x2",c*h-f);a.setAttribute("y2",f);a.setAttribute("style",this.style);e.appendChild(a)}break;case"///":e=document.createElementNS(iep.svgsn,"g");for(c=-1;c<=1;c++){a=document.createElementNS(iep.svgsn,"line");a.setAttribute("x1",c*d+f);a.setAttribute("y1",-f);a.setAttribute("x2",c*d-f);a.setAttribute("y2",f);a.setAttribute("style",this.style);e.appendChild(a)}break;case"\\\\":e=document.createElementNS(iep.svgsn,"g");for(c=-1;c<=1;c+=2){a=document.createElementNS(iep.svgsn,"line");a.setAttribute("x1",c*h-f);a.setAttribute("y1",-f);a.setAttribute("x2",c*h+f);a.setAttribute("y2",f);a.setAttribute("style",this.style);e.appendChild(a)}break;case"\\\\\\":e=document.createElementNS(iep.svgsn,"g");for(c=-1;c<=1;c++){a=document.createElementNS(iep.svgsn,"line");a.setAttribute("x1",c*d-f);a.setAttribute("y1",-f);a.setAttribute("x2",c*d+f);a.setAttribute("y2",f);a.setAttribute("style",this.style);e.appendChild(a)}break;case"X":e=document.createElementNS(iep.svgsn,"g");a=document.createElementNS(iep.svgsn,"line");a.setAttribute("x1",-f);a.setAttribute("y1",-f);a.setAttribute("x2",f);a.setAttribute("y2",f);a.setAttribute("style",this.style);e.appendChild(a);a=document.createElementNS(iep.svgsn,"line");a.setAttribute("x1",f);a.setAttribute("y1",-f);a.setAttribute("x2",-f);a.setAttribute("y2",f);a.setAttribute("style",this.style);e.appendChild(a);break;case"O":e=document.createElementNS(iep.svgsn,"circle");e.setAttribute("cx",0);e.setAttribute("cy",0);e.setAttribute("r",b);e.setAttribute("style",this.style+"fill:none;");break;default:e=document.createElementNS(iep.svgsn,"g")}this.g=e};iep.marqueSegment.prototype.positionne=function(){this.g.setAttribute("transform","translate("+this.x+","+this.y+")")};iep.marqueSegment.prototype.translate=function(a,b){this.x=a;this.y=b;this.positionne()};iep.texte=function(b,d,a,c){iep.objetBase.call(this,b,d,"black");this.x=parseFloat(a);this.y=parseFloat(c);this.taille=20;this.angle=0;this.texte="";this.objet="texte"};iep.texte.prototype=new iep.objetBase();iep.texte.prototype.positionne=function(){this.setPosition(this.x,this.y,this.angle,this.zoomfactor)};iep.texte.prototype.translate=function(a,b){this.x=a;this.y=b;this.positionne()};iep.texte.prototype.updateg=function(b){var a=this.g;this.doc.svg.replaceChild(b,a);this.g=b;b.setAttribute("visibility","visible")};iep.texte.prototype.creeg=function(){this.g=document.createElementNS(iep.svgsn,"g")};iep.texte.prototype.setPosition=function(a,e,d,c){this.x=a;this.y=e;this.angle=d;this.zoomfactor=c;var b=e+parseFloat(this.taille);this.g.setAttribute("transform","scale("+c+") translate("+String(a/c)+","+String(b/c)+") rotate("+d+")")};iep.nomPoint=function(e,f,d,b,c,a){iep.objetBase.call(this,e,f,a);this.dx=(d==null)?2:parseFloat(d);this.dy=(b==null)?4:parseFloat(b);this.nom=iep.remplaceAccentsHtml(iep.remplaceBalises(iep.remplaceCarSpe(c)));this.taille=20;this.point=this.doc.getElement(this.id,"point");this.objet="point";this.nom=this.nom.replace(/\*/g,"×");if(iep.necessiteLatex(c)){this.nom="$"+this.traiteMaths(this.nom)+"$";this.estLatex=true}else{this.nom=iep.traiteAccents(this.nom);this.estLatex=false}};iep.nomPoint.prototype=new iep.objetBase();iep.nomPoint.prototype.creeg=function(){var n,d,o,b,z,t,h,D,a,r,C,c,v,j,x,w,k,u;var m=0;var e="<";var l="£e(";var q="£i(";var A=document.createElementNS(iep.svgsn,"g");var f=parseFloat(this.taille)+2;var B=0;var p=parseFloat(this.taille)*0.4;if(this.nom.length!=0){t=document.createElementNS(iep.svgsn,"text");t.setAttribute("pointer-events","none");t.setAttribute("x",0);t.setAttribute("y",0);var z="text-anchor:left;font-size:"+this.taille+"px;fill:"+this.couleur+";";t.setAttribute("style",z);b=this.nom.replace(new RegExp(" ","g"),"\u00A0");if((this.nom.indexOf(e)===-1)&&(this.nom.indexOf(l)===-1)&&(this.nom.indexOf(q)===-1)&&(this.nom.indexOf("<br>")===-1)){t.appendChild(document.createTextNode(b))}else{x=b.split(/<br>/gi);j=-f;for(w=0;w<x.length;w++){k=true;o=x[w];while(o.length!==0){n=o.indexOf(e);D=o.indexOf(l);a=o.indexOf(q);if(k){j+=f+B}if(D!==-1){j+=p}if((n===-1)&&(D===-1)&&(a===-1)){d=document.createElementNS(iep.svgsn,"tspan");d.setAttribute("pointer-events","none");d.setAttribute("dy",m);if(k){d.setAttribute("x",0);d.setAttribute("y",j);k=false}m=0;d.appendChild(document.createTextNode(o));t.appendChild(d);break}else{while((o.indexOf(e)!==-1)||(o.indexOf(l)!==-1)||(o.indexOf(q)!==-1)){n=o.indexOf(e);D=o.indexOf(l);a=o.indexOf(q);if(n===-1){if(D===-1){r=a}else{r=(a===-1)?D:Math.min(a,D)}}else{if(D===-1){r=(a===-1)?n:Math.min(n,a)}else{if(a===-1){r=Math.min(n,D)}else{r=Math.min(n,a,D)}}}if(r>0){d=document.createElementNS(iep.svgsn,"tspan");d.setAttribute("pointer-events","none");d.setAttribute("dy",m);if(k){d.setAttribute("x",0);d.setAttribute("y",j);k=false}m=0;d.appendChild(document.createTextNode(o.substring(0,r)));t.appendChild(d);o=o.substring(r)}else{if(n===0){var s=new iep.infoBalise(false,false,false,this.couleur,"",this.taille);h=iep.indiceFinBalise(o);if(h===-1){iep.traiteBalise(o,s,t,k,j)}else{iep.traiteBalise(o.substring(0,h),s,t,k,j)}k=false;if(h!==-1){o=o.substring(h)}else{o=""}m=0}else{C=r===D;u=iep.analyseExposantOuIndice(o);d=document.createElementNS(iep.svgsn,"tspan");d.setAttribute("pointer-events","none");d.setAttribute("dy",m+"px");if(k){d.setAttribute("x",0);d.setAttribute("y",j);k=false}if(u.erreur){d.appendChild(document.createTextNode(o))}else{d.appendChild(document.createTextNode(u.operande));t.appendChild(d);d=document.createElementNS(iep.svgsn,"tspan");d.setAttribute("pointer-events","none");d.appendChild(document.createTextNode(u.exposant));m=p;if(C){m=-m}else{B=m}d.setAttribute("dy",m+"px");c=parseFloat(this.taille)*0.6;v="font-size:"+c+"px;";d.setAttribute("style",v);t.appendChild(d);m=-m}o=u.texte}}}}}}}A.appendChild(t);this.g=A}A.setAttribute("visibility","hidden")};iep.nomPoint.prototype.creegLatex=function(){var l,d,j;try{var f=document.createElementNS(iep.svgsn,"g");var c=this.div.childNodes[1];if(c==undefined){return document.createElementNS(iep.svgsn,"g")}var a=c.childNodes[0];if(a==undefined){return document.createElementNS(iep.svgsn,"g")}var n=a.childNodes[0];if(n==undefined){return document.createElementNS(iep.svgsn,"g")}while(n.tagName==="SPAN"){n=n.childNodes[0]}if((n.clientWidth!=0)&&(n.clientHeight!=0)){l=n.clientWidth;d=n.clientHeight}else{var k=n.getBBox();j=k.height/k.width;l=this.div.clientWidth;d=l*j}var m=this.taille;if(d<m){d=m}n.setAttribute("x","0");n.setAttribute("y",String(-this.taille));n.setAttribute("width",l+"px");n.setAttribute("height",d+"px");f.appendChild(n.parentNode.removeChild(n));document.body.removeChild(this.div);f.setAttribute("visibility","hidden");f.setAttribute("id",this.id);this.g=f}catch(i){if(this.div!=null){document.body.removeChild(this.div)}this.g=document.createElementNS(iep.svgsn,"g")}};iep.nomPoint.prototype.positionne=function(){var a=this.point.x;var b=this.point.y;this.g.setAttribute("transform","translate("+String(a+this.dx)+","+String(b+this.dy+this.taille)+")")};iep.nomPoint.prototype.traiteMaths=function(a){return iep.traiteAccents(iep.getMathsForName(a,true))};iep.repere=function(o,c,l,e,i,g,f,b,h,n,d,k,m,j,a){iep.objetBase.call(this,o,"repereIEP",k);this.hauteur=c;this.largeur=l;this.haut=(e==null)?0:parseFloat(e);this.gauche=(i==null)?0:parseFloat(i);this.xgrad=parseFloat(g);this.ygrad=parseFloat(f);this.xmin=parseFloat(b);this.xmax=parseFloat(h);this.ymin=parseFloat(n);this.ymax=parseFloat(d);this.grille=(m==null)?"visible":m;this.axes=(j==null)?"visible":j;this.etiquettes=(a==null)?"visible":a;this.cadre=new Object();this.cadre.gauche=this.gauche*30;this.cadre.haut=this.haut*30;this.cadre.droite=this.cadre.gauche+this.largeur*30;this.cadre.bas=this.cadre.haut+this.hauteur*30};iep.repere.prototype=new iep.objetBase();iep.repere.prototype.mettre_x_en_pixels=function(a){return iep.mettre_en_pixels(a,this.xmin,this.xmax,this.cadre.gauche,this.cadre.droite)};iep.repere.prototype.mettre_y_en_pixels=function(a){return iep.mettre_en_pixels(a,this.ymax,this.ymin,this.cadre.haut,this.cadre.bas)};iep.repere.prototype.tracer_abscisses=function(h,f,d,l,c,k){var m,g;var b=12;var a="stroke:black;stroke-width:0.5;";if(this.grille==="invisible"&&this.axes!=="invisible"){m=document.createElementNS(iep.svgsn,"line");m.setAttribute("style",a);m.setAttribute("x1",this.cadre.gauche);m.setAttribute("y1",l);m.setAttribute("x2",this.cadre.droite);m.setAttribute("y2",l);this.g.appendChild(m)}var j;for(var e=0;e<=d;e++){m=document.createElementNS(iep.svgsn,"line");m.setAttribute("style",a);j=this.mettre_x_en_pixels(h+e*f);if(this.grille==="invisible"){if(this.axes!=="invisible"){m.setAttribute("x1",j);m.setAttribute("y1",String(l-5));m.setAttribute("x2",j);m.setAttribute("y2",String(l+5));this.g.appendChild(m)}}else{m.setAttribute("x1",j);m.setAttribute("y1",c);m.setAttribute("x2",j);m.setAttribute("y2",k);this.g.appendChild(m)}if(this.etiquettes!=="invisible"&&this.axes!=="invisible"){g=document.createElementNS(iep.svgsn,"text");g.setAttribute("x",j+2);g.setAttribute("y",l+b);var n="text-anchor:left;font-size:"+b+"px;fill:"+this.couleur+";";g.setAttribute("style",n);g.appendChild(document.createTextNode(String(h+e*f)));this.g.appendChild(g)}}};iep.repere.prototype.tracer_ordonnees=function(h,e,d,c,k,n){var l,g;var b=12;var a="stroke:black;stroke-width:0.5;";if(this.grille==="invisible"&&this.axes!=="invisible"){l=document.createElementNS(iep.svgsn,"line");l.setAttribute("style",a);l.setAttribute("x1",c);l.setAttribute("y1",this.cadre.haut);l.setAttribute("x2",c);l.setAttribute("y2",this.cadre.bas);this.g.appendChild(l)}var j;for(var f=0;f<=d;f++){l=document.createElementNS(iep.svgsn,"line");l.setAttribute("style",a);j=this.mettre_y_en_pixels(h+f*e);if(this.grille==="invisible"){if(this.axes!=="invisible"){l.setAttribute("x1",String(c-5));l.setAttribute("y1",j);l.setAttribute("x2",String(c+5));l.setAttribute("y2",j);this.g.appendChild(l)}}else{l.setAttribute("x1",k);l.setAttribute("y1",j);l.setAttribute("x2",n);l.setAttribute("y2",j);this.g.appendChild(l)}if(this.etiquettes!=="invisible"&&this.axes!=="invisible"){g=document.createElementNS(iep.svgsn,"text");g.setAttribute("x",c+2);g.setAttribute("y",j+b);var m="text-anchor:left;font-size:"+b+"px;fill:"+this.couleur+";";g.setAttribute("style",m);g.appendChild(document.createTextNode(String(h+f*e)));this.g.appendChild(g)}}};iep.repere.prototype.creeg=function(){var b=this.cadre.droite-this.cadre.gauche;var m=this.cadre.bas-this.cadre.haut;this.g=document.createElementNS(iep.svgsn,"g");var g=document.createElementNS(iep.svgsn,"defs");var d=document.createElementNS(iep.svgsn,"clipPath");d.setAttribute("id","clipRepere");var l=document.createElementNS(iep.svgsn,"rect");l.setAttribute("style",a);l.setAttribute("x",this.cadre.gauche);l.setAttribute("y",this.cadre.haut);l.setAttribute("width",b);l.setAttribute("height",m);d.appendChild(l);g.appendChild(d);this.g.appendChild(g);this.g.setAttribute("style","clip-path:url(#clipRepere)");if((this.xmax-this.xmin)>this.xgrad){var f=Math.floor((this.xmax-this.xmin)/this.xgrad);var j;if(this.ymax*this.ymin<0){j=this.mettre_y_en_pixels(0)}else{if(this.ymax<0){j=this.cadre.haut}else{j=this.cadre.bas}}var i=iep.determiner_graduations(this.xmin,this.xmax,this.xgrad);this.tracer_abscisses(i,this.xgrad,f,j,this.cadre.haut,this.cadre.bas)}if((this.ymax-this.ymin)>this.ygrad){var e=Math.floor((this.ymax-this.ymin)/this.ygrad);var c;if(this.xmax*this.xmin<0){c=this.mettre_x_en_pixels(0)}else{if(this.xmax<0){c=this.cadre.droite}else{c=this.cadre.gauche}}var h=iep.determiner_graduations(this.ymin,this.ymax,this.ygrad);this.tracer_ordonnees(h,this.ygrad,e,c,this.cadre.gauche,this.cadre.droite)}var k=document.createElementNS(iep.svgsn,"rect");var a="stroke:"+this.couleur+";stroke-width:1;fill:none;";k.setAttribute("style",a);k.setAttribute("x",this.cadre.gauche);k.setAttribute("y",this.cadre.haut);k.setAttribute("width",b);k.setAttribute("height",m);this.g.appendChild(k);this.g.setAttribute("visibility","hidden")};iep.quadrillage=function(g,f,d,c,b,e,a){iep.objetBase.call(this,g,"quadrillageIEP",a);this.hauteur=parseFloat(d);this.largeur=parseFloat(c);this.haut=(b==null)?0:parseFloat(b);this.gauche=(e==null)?0:parseFloat(e);this.type=f;this.cadre=new Object();this.cadre.gauche=this.gauche*30;this.cadre.haut=this.haut*30;this.cadre.droite=this.cadre.gauche+this.largeur*30;this.cadre.bas=this.cadre.haut+this.hauteur*30;this.objet="quadrillage"};iep.quadrillage.prototype=new iep.objetBase();iep.quadrillage.prototype.creeg=function(){var e=this.cadre.gauche;var f=this.cadre.droite;var b=this.cadre.haut;var d=this.cadre.bas;var a=this.couleur;this.g=document.createElementNS(iep.svgsn,"g");var c=this.doc.svg.getElementById("quadrillageIEP");if(c!=null){this.doc.svg.removeChild(c)}switch(this.type){case"seyes":this.tracer_grille(a,24,6,e,b,f,d,false,1);this.tracer_grille(a,24,24,e,b,f,d,false,1);break;case"millimetre":this.tracer_grille(a,3,3,e,b,f,d,false,0.6);this.tracer_grille(a,30,30,e,b,f,d,false,0.8);this.tracer_grille(a,150,150,e,b,f,d,false,1);break;case"10x10":case"10x":this.tracer_grille(a,30,30,e,b,f,d,false,1);break;case"5x5":case"5x":default:this.tracer_grille(a,15,15,e,b,f,d,false,1);break}};iep.quadrillage.prototype.tracer_grille=function(l,b,n,d,a,h,g,e,f){var m;var c="stroke:"+l+";stroke-width:0.5;stroke-opacity:"+f+";";if(e){this.style+="stroke-dasharray:2 2;"}var k=Math.ceil(Math.abs(h-d)/b);for(var j=0;j<k;j++){m=document.createElementNS(iep.svgsn,"line");m.setAttribute("style",c);m.setAttribute("x1",d+j*b);m.setAttribute("y1",a);m.setAttribute("x2",d+j*b);m.setAttribute("y2",g);m.setAttribute("style",c);this.g.appendChild(m)}k=Math.ceil(Math.abs(g-a)/n);for(var j=0;j<k;j++){m=document.createElementNS(iep.svgsn,"line");m.setAttribute("style",c);m.setAttribute("x1",d);m.setAttribute("y1",a+j*n);m.setAttribute("x2",h);m.setAttribute("y2",a+j*n);m.setAttribute("style",c);this.g.appendChild(m)}};iep.axe=function(j,b,i,d,g,c,e,a,f,h){iep.objetBase.call(this,j,"axeIEP",h);this.pente=(b==null)?"horizontal":b;this.largeur=i;this.haut=(d==null)?0:parseFloat(d);this.gauche=(g==null)?0:parseFloat(g);this.distanceBord=parseFloat(c);this.xgrad=e;this.xmin=a;this.xmax=f;this.cadre=new Object();this.cadre.gauche=this.gauche*30;this.cadre.haut=this.haut*30;this.width=30*i;this.cadre.droite=this.gauche+this.width;this.cadre.bas=this.haut+this.width};iep.axe.prototype=new iep.objetBase();iep.axe.prototype.creeg=function(){var a;this.g=document.createElementNS(iep.svgsn,"g");var c="stroke:black;stroke-width:1;";if(this.pente==="horizontal"&&(this.xmax-this.xmin)>this.xgrad){var d=Math.floor((this.xmax-this.xmin)/this.xgrad);var b=this.distanceBord*30;var e=iep.determiner_graduations(this.xmin,this.xmax,this.xgrad);this.tracer_abscisses(e,this.xgrad,d,b,b-10,b+10);a=document.createElementNS(iep.svgsn,"line");a.setAttribute("style",c);a.setAttribute("x1",this.cadre.gauche);a.setAttribute("y1",b);a.setAttribute("x2",this.cadre.droite);a.setAttribute("y2",b);this.g.appendChild(a)}else{if((this.xmax-this.xmin)>this.xgrad){var d=Math.floor((this.xmax-this.xmin)/this.xgrad);var b=Number(this.distanceBord)*30;var e=iep.determiner_graduations(this.xmin,this.xmax,this.xgrad);this.tracer_ordonnees(e,this.xgrad,d,b,b-10,b+10);a=document.createElementNS(iep.svgsn,"line");a.setAttribute("style",c);a.setAttribute("x1",b);a.setAttribute("y1",this.cadre.bas);a.setAttribute("x2",b);a.setAttribute("y2",this.cadre.haut);this.g.appendChild(a)}}};iep.axe.prototype.tracer_abscisses=function(h,f,d,l,c,k){var m,g;var b=12;var a="stroke:black;stroke-width:1.5;";m=document.createElementNS(iep.svgsn,"line");m.setAttribute("style",a);m.setAttribute("x1",this.cadre.gauche);m.setAttribute("y1",l);m.setAttribute("x2",this.cadre.droite);m.setAttribute("y2",l);this.g.appendChild(m);var j;for(var e=0;e<=d;e++){m=document.createElementNS(iep.svgsn,"line");m.setAttribute("style",a);j=this.mettre_x_en_pixels(h+e*f);m.setAttribute("x1",j);m.setAttribute("y1",String(l-5));m.setAttribute("x2",j);m.setAttribute("y2",String(l+5));this.g.appendChild(m);g=document.createElementNS(iep.svgsn,"text");g.setAttribute("x",j);g.setAttribute("y",l+b+5);var n="text-anchor:left;font-size:"+b+"px;fill:"+this.couleur+";";g.setAttribute("style",n);g.appendChild(document.createTextNode(String(h+e*f)));this.g.appendChild(g)}};iep.axe.prototype.tracer_ordonnees=function(h,e,d,c,k,n){var l,g;var b=12;var a="stroke:black;stroke-width:1.5;";l=document.createElementNS(iep.svgsn,"line");l.setAttribute("style",a);l.setAttribute("x1",c);l.setAttribute("y1",this.cadre.haut);l.setAttribute("x2",c);l.setAttribute("y2",this.cadre.bas);this.g.appendChild(l);var j;for(var f=0;f<=d;f++){l=document.createElementNS(iep.svgsn,"line");l.setAttribute("style",a);j=this.mettre_y_en_pixels(h+f*e);l.setAttribute("x1",String(c-5));l.setAttribute("y1",j);l.setAttribute("x2",String(c+5));l.setAttribute("y2",j);this.g.appendChild(l);g=document.createElementNS(iep.svgsn,"text");g.setAttribute("x",c+10);g.setAttribute("y",j+2);var m="text-anchor:left;font-size:"+b+"px;fill:"+this.couleur+";";g.setAttribute("style",m);g.appendChild(document.createTextNode(String(h+f*e)));this.g.appendChild(g)}};iep.axe.prototype.mettre_x_en_pixels=function(a){return iep.mettre_en_pixels(a,this.xmin,this.xmax,this.cadre.gauche,this.cadre.droite)};iep.axe.prototype.mettre_y_en_pixels=function(a){return iep.mettre_en_pixels(a,this.xmax,this.xmin,this.cadre.haut,this.cadre.bas)};iep.actionAncetre=function(b,a){if(arguments.length===0){return}this.doc=b;this.tempo=(a===null)?null:parseInt(a)*100;this.isReady=false};iep.actionAncetre.prototype.setReady=function(){this.isReady=true};iep.actionAncetre.prototype.creegElement=function(){};iep.actionAncetre.prototype.actionVisible=function(){return true};iep.actionCreation=function(e,f,a,c,d){iep.actionAncetre.call(this,e,c);this.id=f;var b=this.doc.getElement(f,a.objet);this.objetRemplace=(b===null)?null:b;this.objet=a;if(arguments.length>=5){this.vitesse=(d!=null)?Math.abs(parseInt(d)):8}else{this.vitesse=8}if(this.objetRemplace!==null){this.doc.addElement(this.objet)}else{this.doc.pushElement(this.objet)}};iep.actionCreation.prototype=new iep.actionAncetre();iep.actionCreation.prototype.execute=function(a){if(this.objetRemplace!==null){this.objetRemplace.montre(false)}if(this.objet.creationAnimee()&&!a){this.objet.lanceAnimation(this.vitesse)}else{this.objet.montre(true);if(a){this.objet.finAction()}else{this.doc.actionSuivante(a)}}};iep.actionCreation.prototype.creegElement=function(){var b=this.doc;var a=this.objet;a.creeg();a.positionne();a.g.setAttribute("visibility","hidden");b.svg.appendChild(a.g)};iep.actionCreation.prototype.actionVisible=function(){return !(this.objet instanceof iep.texte)};iep.actionMasquer=function(d,c,b,a){iep.actionAncetre.call(this,d,a);this.objet=this.doc.getElement(c,b)};iep.actionMasquer.prototype=new iep.actionAncetre();iep.actionMasquer.prototype.execute=function(a){var b=this.objet;if(b!=null){b.montre(false)}if(!a){this.doc.actionSuivante(a)}};iep.actionMasquer.prototype.actionVisible=function(){return this.doc.getObjectVisibility(this.objet,this.indice-1)};iep.actionMontrer=function(d,c,b,a){iep.actionAncetre.call(this,d,a);this.objet=this.doc.getElement(c,b)};iep.actionMontrer.prototype=new iep.actionAncetre();iep.actionMontrer.prototype.execute=function(a){var b=this.objet;if(b!==null){b.montre(true)}if(!a){this.doc.actionSuivante(a)}};iep.actionMontrer.prototype.actionVisible=function(){return !this.doc.getObjectVisibility(this.objet,this.indice-1)};iep.actionMasquerInstrument=function(c,b,a){iep.actionAncetre.call(this,c,a);this.instrument=b};iep.actionMasquerInstrument.prototype=new iep.actionAncetre();iep.actionMasquerInstrument.prototype.execute=function(a){var b=this.doc.compas;this.instrument.montre(false);if(b.leve){this.doc.compasLeve.montre(false)}if(!a){this.doc.actionSuivante(a)}};iep.actionMasquerInstrument.prototype.actionVisible=function(){return this.doc.getInstrumentVisibility(this.instrument,this.indice-1)};iep.actionMontrerInstrument=function(d,c,a,e,b){iep.actionAncetre.call(this,d,b);this.x=(a===null)?null:parseFloat(a);this.y=(e===null)?null:parseFloat(e);this.instrument=c};iep.actionMontrerInstrument.prototype=new iep.actionAncetre();iep.actionMontrerInstrument.prototype.execute=function(a){var b=this.doc.compas;if((this.x!==null)&&(this.y!==null)){this.instrument.translate(this.x,this.y)}if((this.instrument===b)&&!a){if(!b.leve){b.montre(true)}else{this.doc.compasLeve.montre(true)}b.visible=true}else{this.instrument.montre(true)}if(!a){this.doc.actionSuivante(a)}};iep.actionMontrerInstrument.prototype.actionVisible=function(){return !this.doc.getInstrumentVisibility(this.instrument,this.indice-1)};iep.actionRotationInstrument=function(e,d,b,c,a){iep.actionAncetre.call(this,e,c);this.instrument=d;this.anglefin=parseFloat(b);this.deg10=(a==null)?8:Math.abs(parseFloat(a))};iep.actionRotationInstrument.prototype=new iep.actionAncetre();iep.actionRotationInstrument.prototype.execute=function(a){if(!a){this.instrument.lanceAnimationRotation(this.anglefin,this.deg10)}else{this.instrument.angle=this.anglefin;this.instrument.positionne();if(!a){this.doc.actionSuivante(a)}}};iep.actionRotationInstrument.prototype.actionVisible=function(){return this.doc.getInstrumentVisibility(this.instrument,this.indice-1)};iep.actionTranslationInstrument=function(e,d,a,f,c,b){iep.actionAncetre.call(this,e,c);this.instrument=d;this.xfin=parseFloat(a);this.yfin=parseFloat(f);this.pix10=(b==null)?8:parseFloat(b)};iep.actionTranslationInstrument.prototype=new iep.actionAncetre();iep.actionTranslationInstrument.prototype.execute=function(a){if(isNaN(this.xfin)||isNaN(this.yfin)){this.doc.actionSuivante(a)}else{if(a){this.instrument.translate(this.xfin,this.yfin)}else{this.instrument.lanceAnimationTranslation(this.xfin,this.yfin,this.pix10)}}};iep.actionTranslationInstrument.prototype.actionVisible=function(){return this.doc.getInstrumentVisibility(this.instrument,this.indice-1)};iep.actionEcarterCompas=function(b,d,a,c){iep.actionAncetre.call(this,b,a);this.ecartement=d;this.ec10=(c===null)?16:parseFloat(c)};iep.actionEcarterCompas.prototype=new iep.actionAncetre();iep.actionEcarterCompas.prototype.execute=function(a){if(!a){this.doc.compas.lanceAnimationEcartement(this.ecartement,this.ec10)}else{this.doc.compas.ecart=this.ecartement;this.doc.compas.positionne()}};iep.actionEcarterCompas.prototype.actionVisible=function(){return this.doc.getInstrumentVisibility(this.doc.compas,this.indice-1)};iep.actionLeverCompas=function(b,a){iep.actionAncetre.call(this,b,a)};iep.actionLeverCompas.prototype=new iep.actionAncetre();iep.actionLeverCompas.prototype.execute=function(a){var b=this.doc.compas;if(b.visible){b.montre(false);b.visible=true}this.doc.compasLeve=new iep.compasLeve(this.doc,b.x,b.y,b.angle,b.ecart);if(!a&&b.visible){this.doc.compasLeve.montre(true)}b.leve=true;if(!a){this.doc.actionSuivante(a)}};iep.actionLeverCompas.prototype.actionVisible=function(){var a=this.doc.getInstrumentVisibility(this.doc.compas,this.indice-1);if(!a){return false}else{return this.doc.getCompasStatus(this.indice-1)=="couche"}};iep.actionCoucherCompas=function(b,a){iep.actionAncetre.call(this,b,a)};iep.actionCoucherCompas.prototype=new iep.actionAncetre();iep.actionCoucherCompas.prototype.execute=function(b){var c=this.doc.compas;var a=this.doc.compasLeve;if(c.leve){a.montre(false);c.setPosition(a.x,a.y,a.angle)}if(!b&&c.visible){c.montre(true)}c.leve=false;if(!b){this.doc.actionSuivante(b)}};iep.actionCoucherCompas.prototype.actionVisible=function(){var a=this.doc.getInstrumentVisibility(this.doc.compas.compas,this.indice-1);if(!a){return false}else{return this.doc.getCompasStatus(this.indice-1)=="leve"}};iep.actionMontrerNombres=function(c,b,a){iep.actionAncetre.call(this,c,a);this.bmontrer=b};iep.actionMontrerNombres.prototype=new iep.actionAncetre();iep.actionMontrerNombres.prototype.execute=function(a){this.doc.rapporteur.montreGraduationsExternes(this.bmontrer);if(!a){this.doc.actionSuivante(a)}};iep.actionMontrerNombres.prototype.actionVisible=function(){return this.doc.getInstrumentVisibility(this.doc.rapporteur,this.indice-1)};iep.actionMontrerGraduations=function(d,b,c,a){iep.actionAncetre.call(this,d,a);this.instrument=b;this.bmontrer=c};iep.actionMontrerGraduations.prototype=new iep.actionAncetre();iep.actionMontrerGraduations.prototype.execute=function(a){this.instrument.montreGraduations(this.bmontrer);if(!a){this.doc.actionSuivante(a)}};iep.actionMontrerGraduations.prototype.actionVisible=function(){return this.doc.getInstrumentVisibility(this.instrument,this.indice-1)};iep.actionRetourner=function(b,a){iep.actionAncetre.call(this,b,a)};iep.actionRetourner.prototype=new iep.actionAncetre();iep.actionRetourner.prototype.execute=function(a){this.doc.compas.retourne();if(!a){this.doc.actionSuivante(a)}};iep.actionRetourner.prototype.actionVisible=function(){return this.doc.getInstrumentVisibility(this.doc.compas,this.indice-1)};iep.actionGlisser=function(d,c,b,a){iep.actionAncetre.call(this,d,b);this.abscisseFin=parseFloat(c);this.pix10=(a===null)?8:String(Math.abs(a))};iep.actionGlisser.prototype=new iep.actionAncetre();iep.actionGlisser.prototype.execute=function(a){if(!a){this.doc.requerre.lanceAnimationGlissement(this.abscisseFin,this.pix10)}else{this.doc.requerre.setAbs(this.abscisseFin);this.doc.requerre.positionne()}};iep.actionGlisser.prototype.actionVisible=function(){return this.doc.getInstrumentVisibility(this.doc.requerre,this.indice-1)};iep.actionTranslationObjet=function(f,e,a,g,d,c,b){iep.actionAncetre.call(this,f,c);this.xfin=parseFloat(a);this.yfin=parseFloat(g);this.pix10=(b==null)?8:parseFloat(b);this.type=d;this.objet=this.doc.getElement(e,d)};iep.actionTranslationObjet.prototype=new iep.actionAncetre();iep.actionTranslationObjet.prototype.execute=function(b){var a=this.objet;if(a==null){this.doc.actionSuivante(b);return}if(!b){a.lanceAnimationTranslation(this.xfin,this.yfin,this.pix10)}else{a.x=this.xfin;a.y=this.yfin;a.positionne()}};iep.actionTranslationObjet.prototype.actionVisible=function(){return this.doc.getObjectVisibility(this.objet,this.indice-1)};iep.actionRotationObjet=function(f,e,b,d,c,a){iep.actionAncetre.call(this,f,c);this.anglefin=parseFloat(b);this.deg10=(a==null)?8:Math.abs(parseFloat(a));this.objet=this.doc.getElement(e,d)};iep.actionRotationObjet.prototype=new iep.actionAncetre();iep.actionRotationObjet.prototype.execute=function(b){var a=this.objet;if(a==null){if(!b){this.doc.actionSuivante(b)}return}if(!b){a.lanceAnimationRotation(this.anglefin,this.deg10,this.tempo)}else{a.angle=this.anglefin;a.positionne()}};iep.actionRotationObjet.prototype.actionVisible=function(){return this.doc.getObjectVisibility(this.objet,this.indice-1)};iep.actionZoomObjet=function(f,d,a,c,b,e){iep.actionAncetre.call(this,f,b);this.objet=this.doc.getElement(d,c);this.zoomfin=parseFloat(a)/100;this.vitesse=e;this.type=c};iep.actionZoomObjet.prototype=new iep.actionAncetre();iep.actionZoomObjet.prototype.execute=function(b){var a=this.objet;if(a==null){this.doc.actionSuivante(b);return}if(!b){a.lanceAnimationZoom(this.zoomfin,this.vitesse)}else{a.zoomfactor=this.zoomfin;a.positionne()}};iep.actionTranslationObjet.prototype.actionVisible=function(){return this.doc.getObjectVisibility(this.objet,this.indice-1)};iep.actionZoomInstrument=function(e,c,a,b,d){iep.actionAncetre.call(this,e,b);this.instrument=c;this.zoomfin=parseFloat(a)/100;this.vitesse=parseInt(d)};iep.actionZoomInstrument.prototype=new iep.actionAncetre();iep.actionZoomInstrument.prototype.execute=function(a){if(!a){this.instrument.lanceAnimationZoom(this.zoomfin,this.vitesse)}else{this.instrument.zoomfactor=this.zoomfin;this.instrument.positionne()}};iep.actionZoomInstrument.prototype.actionVisible=function(){return this.doc.getInstrumentVisibility(this.instrument,this.indice-1)};var iep;if(!iep){iep={}}iep.actionEcrireTexte=function(m,c,k,e,n,b,p,d,f,i,l,j,a,o,g,h){iep.actionAncetre.call(this,m,h);this.txt=this.doc.getElement(c,"texte");this.id=c;this.couleur=k;this.taille=(e==null)?"20":e.replace(/O/g,"0");this.texte=iep.remplaceAccentsHtml(iep.remplaceBalises(iep.remplaceCarSpe(n)));this.style=(b===null)?"texte":b;this.couleurFond=p;this.opaciteFond=(d==null)?"0.6":parseFloat(d)/100;this.couleurCadre=(f==null)?k:f;this.epaisseurCadre=(i!=null)?i:((f==null)?0:1);this.marge=(l==null)?0:parseFloat(l);this.margeGauche=(j==null)?0:parseFloat(j);this.margeDroite=(a==null)?0:parseFloat(a);this.margeHaut=(o==null)?0:parseFloat(o);this.margeBas=(g==null)?0:parseFloat(g);this.estLatex=this.estAffichageLatex();this.texte=this.traduitCaracteresGrecs(this.texte);if(!this.estLatex){this.texte=this.texte.replace(/\*/g,"×");if(iep.necessiteLatex(n)){this.texte="$"+this.traiteMaths(this.texte)+"$";this.estLatex=true}else{this.texte=iep.traiteAccents(this.texte)}}};iep.actionEcrireTexte.prototype=new iep.actionAncetre();iep.actionEcrireTexte.prototype.execute=function(b){if(this.txt!=null){this.angle=0;var a=this.txt;a.couleur=this.couleur;a.taille=this.taille;a.texte=this.texte;a.couleurFond=this.couleurFond;a.couleurCadre=this.couleurCadre;a.epaisseurCadre=this.epaisseurCadre;a.updateg(this.g);a.positionne()}if(!b){this.doc.actionSuivante(b)}};iep.actionEcrireTexte.prototype.estAffichageLatex=function(){return((this.texte.charAt(0)==="$")&&(this.texte.charAt(this.texte.length-1)==="$"))};iep.actionEcrireTexte.prototype.traduitCaracteresGrecs=function(d){var c,a,b;a=iep.caracteresGrecs;if(d.indexOf("£")!==-1){for(c=0;c<a.length;c++){b="£"+a[c]+"£";if(d.indexOf(b)!==-1){d=d.replace(new RegExp(b,"g"),iep.caracteresGrecsUtf8[c])}}}return d};iep.contientBaliseLaTeX=function(a){return(a.indexOf("\\frac")!==-1)||(a.indexOf("\\sqrt")!==-1)||(a.indexOf("}^{")!==-1)||(a.indexOf("}_{")!==-1)||(a.indexOf("\\widehat{")!==-1)||(a.indexOf("\\left[")!==-1)||(a.indexOf("\\left(")!==-1)||(a.indexOf("\\left|")!==-1)||(a.indexOf("\\left\\|")!==-1)||(a.indexOf("\\overrightarrow{")!==-1)||(a.indexOf("\\text{")!==-1)};iep.actionEcrireTexte.prototype.traiteMaths=function(g){var f;var d=g;var c=this.style==="texte";var b=d.split(new RegExp("<br>|</br>","gi"));if(b.length<=1){return iep.traiteAccents(iep.getMaths(g,c))}var e="\\begin{array}{l}";for(var f=0;f<b.length;f++){if(f!==0){e+="\\\\"}e+=iep.traiteAccents(iep.getMaths(b[f],c))}e+="\\end{array}";return e};iep.actionEcrireTexte.prototype.prepare=function(){if(!this.estLatex){this.creeg();this.setReady()}else{this.div=document.createElement("div");this.div.setAttribute("style","top:0px;left:0px;position:absolute;font-size:"+String(this.taille-2)+"px;visibility:hidden;");this.div.setAttribute("id",this.id+"iepprov");var b="$$"+this.prelatex()+this.texte.substring(1)+"$";this.div.appendChild(document.createTextNode(b));document.body.appendChild(this.div);MathJax.Hub.Queue(["Typeset",MathJax.Hub,this.div]);var a=this;MathJax.Hub.Queue([function(){a.creegLatex()}]);MathJax.Hub.Queue([this.callBack,this])}};iep.actionEcrireTexte.prototype.callBack=function(a){a.setReady();a.doc.waitForReadyState()};iep.actionEcrireTexte.prototype.prelatex=function(){return"\\color{"+this.couleur+"}"};iep.actionEcrireTexte.prototype.creegLatex=function(){var m,d,j;try{var f=document.createElementNS(iep.svgsn,"g");var c=this.div.childNodes[1];if(c==undefined){return document.createElementNS(iep.svgsn,"g")}var a=c.childNodes[0];if(a==undefined){return document.createElementNS(iep.svgsn,"g")}var o=a.childNodes[0];if(o==undefined){return document.createElementNS(iep.svgsn,"g")}while(o.tagName==="SPAN"){o=o.childNodes[0]}if((o.clientWidth!=0)&&(o.clientHeight!=0)){m=o.clientWidth;d=o.clientHeight}else{var l=o.getBBox();j=l.height/l.width;m=this.div.clientWidth;d=m*j}var n=this.taille;if(d<n){d=n}o.setAttribute("x","0");o.setAttribute("y",String(-this.taille));o.setAttribute("width",m+"px");o.setAttribute("height",d+"px");f.appendChild(o.parentNode.removeChild(o));document.body.removeChild(this.div);f.setAttribute("visibility","hidden");f.setAttribute("id",this.id);if((this.couleurFond!=null)||(this.couleurCadre!=null)){f.setAttribute("visible","hidden");this.doc.svg.appendChild(f);this.rectAff=new Object();var k=parseFloat(this.epaisseurCadre);this.rectAff.height=f.getBBox().height+2*k+4+2*this.marge+this.margeHaut+this.margeBas;this.rectAff.width=f.getBBox().width+2*k+2+2*this.marge+this.margeGauche+this.margeDroite;this.rectAff.x=f.getBBox().x-k-1-this.marge-this.margeGauche;this.rectAff.y=f.getBBox().y-k-1-this.marge-this.margeHaut;f.setAttribute("visible","visible");this.doc.svg.removeChild(f);this.creeRectangle(f,(this.couleurFond==null)?"white":this.couleurFond)}this.g=f}catch(i){if(this.div!=null){document.body.removeChild(this.div)}this.g=document.createElementNS(iep.svgsn,"g")}};iep.actionEcrireTexte.prototype.creeg=function(){var n,d,o,b,z,t,h,E,a,r,D,c,v,j,x,w,k,u;var m=0;var e="<";var l="£e(";var q="£i(";var A=document.createElementNS(iep.svgsn,"g");var f=parseFloat(this.taille)+2;var B=0;var p=parseFloat(this.taille)*0.4;if(this.texte!=""){t=document.createElementNS(iep.svgsn,"text");t.setAttribute("pointer-events","none");t.setAttribute("x",0);t.setAttribute("y",0);var z="text-anchor:left;font-size:"+this.taille+"px;fill:"+this.couleur+";";t.setAttribute("style",z);b=this.texte.replace(new RegExp(" ","g"),"\u00A0");if((this.texte.indexOf(e)===-1)&&(this.texte.indexOf(l)===-1)&&(this.texte.indexOf(q)===-1)&&(this.texte.indexOf("<br>")===-1)){t.appendChild(document.createTextNode(b))}else{x=b.split(/<br>/gi);j=-f;for(w=0;w<x.length;w++){k=true;o=x[w];while(o!=""){n=o.indexOf(e);E=o.indexOf(l);a=o.indexOf(q);if(k){j+=f+B}if(E!==-1){j+=p}if((n===-1)&&(E===-1)&&(a===-1)){d=document.createElementNS(iep.svgsn,"tspan");d.setAttribute("pointer-events","none");d.setAttribute("dy",m);if(k){d.setAttribute("x",0);d.setAttribute("y",j);k=false}m=0;d.appendChild(document.createTextNode(o));t.appendChild(d);break}else{while((o.indexOf(e)!==-1)||(o.indexOf(l)!==-1)||(o.indexOf(q)!==-1)){n=o.indexOf(e);E=o.indexOf(l);a=o.indexOf(q);if(n===-1){if(E===-1){r=a}else{r=(a===-1)?E:Math.min(a,E)}}else{if(E===-1){r=(a===-1)?n:Math.min(n,a)}else{if(a===-1){r=Math.min(n,E)}else{r=Math.min(n,a,E)}}}if(r>0){d=document.createElementNS(iep.svgsn,"tspan");d.setAttribute("pointer-events","none");d.setAttribute("dy",m);if(k){d.setAttribute("x",0);d.setAttribute("y",j);k=false}m=0;d.appendChild(document.createTextNode(o.substring(0,r)));t.appendChild(d);o=o.substring(r)}else{if(n===0){var s=new iep.infoBalise(false,false,false,this.couleur,"",this.taille);h=iep.indiceFinBalise(o);if(h===-1){iep.traiteBalise(o,s,t,k,j)}else{iep.traiteBalise(o.substring(0,h),s,t,k,j)}k=false;if(h!==-1){o=o.substring(h)}else{o=""}m=0}else{D=r===E;u=iep.analyseExposantOuIndice(o);d=document.createElementNS(iep.svgsn,"tspan");d.setAttribute("pointer-events","none");d.setAttribute("dy",m+"px");if(k){d.setAttribute("x",0);d.setAttribute("y",j);k=false}if(u.erreur){d.appendChild(document.createTextNode(o))}else{d.appendChild(document.createTextNode(u.operande));t.appendChild(d);d=document.createElementNS(iep.svgsn,"tspan");d.setAttribute("pointer-events","none");d.appendChild(document.createTextNode(u.exposant));m=p;if(D){m=-m}else{B=m}d.setAttribute("dy",m+"px");c=parseFloat(this.taille)*0.6;v="font-size:"+c+"px;";d.setAttribute("style",v);t.appendChild(d);m=-m}o=u.texte}}}}}}}A.appendChild(t)}A.setAttribute("visibility","hidden");A.setAttribute("id",this.id);if((this.couleurFond!=null)||(this.couleurCadre!=null)){A.setAttribute("visible","hidden");this.doc.svg.appendChild(A);this.rectAff=new Object();var C=parseFloat(this.epaisseurCadre);this.rectAff.height=A.getBBox().height+2*C+3+2*this.marge+this.margeHaut+this.margeBas;this.rectAff.width=A.getBBox().width+2*C+2+2*this.marge+this.margeGauche+this.margeDroite;this.rectAff.x=A.getBBox().x-C-1-this.marge-this.margeGauche;this.rectAff.y=A.getBBox().y-C-1-this.marge-this.margeHaut;A.setAttribute("visible","visible");this.doc.svg.removeChild(A);this.creeRectangle(A,(this.couleurFond==null)?"white":this.couleurFond)}this.g=A};iep.actionEcrireTexte.prototype.contientBalisesItaliqueOuUnderlineOuFontOuBold=function(a){var b=new RegExp(/<(u|b|i|font[^>]+)>/,"gi");return b.test(a)};iep.actionEcrireTexte.prototype.creeRectangle=function(c,d){var b=document.createElementNS(iep.svgsn,"rect");var a="stroke-width:"+this.epaisseurCadre+"px;stroke:"+this.couleurCadre+";fill:"+d+";fill-opacity:"+this.opaciteFond+";";b.setAttribute("style",a);b.setAttribute("x",this.rectAff.x);b.setAttribute("y",this.rectAff.y);b.setAttribute("width",this.rectAff.width);b.setAttribute("height",this.rectAff.height);b.setAttribute("pointer-events","none");c.insertBefore(b,c.childNodes[0])};iep.traiteAccents=function(d){var j,q,h,o,g,f;var n="éèàùâêô";var m=["acute","grave","grave","grave","hat","hat","hat"];var l="eeauaeo";d=d.replace(/£virg£/gi,",");d=d.replace(/£virgule£/gi,",");f=false;for(h=0;h<n.length;h++){f=f||(d.indexOf(n.charAt(h))!=0)}if(!f||d.indexOf("\\text{")==-1){return d}var k="";var e=-1;var p=0;while(((e=d.indexOf("\\text{",p))!=-1)&&(p<d.length)){j=iep.accoladeFermante(d,e+6);if(j===-1){break}k=k+d.substring(p,e);q=d.substring(e+6,j+1);for(h=0;h<n.length;h++){o=n.charAt(h);g=l.charAt(h);if(q.charAt(0)===o){q="\\"+m[h]+"{"+g+"}\\text{"+q.substring(1)}if(q.charAt(q.length-1)===o){q=q.substring(0,q.length-1)+"\\"+m[h]+"{"+g+"}"}q=q.replace(new RegExp(o,"g"),"}\\"+m[h]+"{"+g+"} \\text{")}f=false;for(h=0;h<n.length;h++){f=f||(q.indexOf("\\"+m[h])===0)}if(f){k=k+q}else{k=k+"\\text{"+q}p=j+1}if(p<d.length){k=k+d.substring(p)}return k};iep.accoladeFermante=function(b,a){var e;var d;var c;c=1;e=a+1;while(e<b.length){d=b.charAt(e);if(d=="{"){c++}else{if(d=="}"){c--}}if(c==0){break}e++}if(c==0){return e}else{return -1}};iep.actionNommerPoint=function(c,a,b){iep.actionAncetre.call(this,c,b);this.nomPoint=a};iep.actionNommerPoint.prototype=new iep.actionAncetre();iep.actionNommerPoint.prototype.prepare=function(){if(!this.nomPoint.estLatex){this.nomPoint.creeg();this.setReady()}else{this.nomPoint.div=document.createElement("div");this.nomPoint.div.setAttribute("style","top:0px;left:0px;position:absolute;font-size:"+String(this.taille-2)+"px;visibility:hidden;");this.nomPoint.div.setAttribute("id",this.nomPoint.id+"iepprov");var b="$$"+this.nomPoint.nom.substring(1)+"$";this.nomPoint.div.appendChild(document.createTextNode(b));document.body.appendChild(this.nomPoint.div);MathJax.Hub.Queue(["Typeset",MathJax.Hub,this.nomPoint.div]);var a=this;MathJax.Hub.Queue([function(){a.nomPoint.creegLatex()}]);MathJax.Hub.Queue([this.callBack,this])}};iep.actionNommerPoint.prototype.execute=function(b){if(this.nomPoint.objet==="point"){this.nomPoint.positionne();var a=this.nomPoint.point;if(a.nom!==null){this.doc.svg.replaceChild(this.nomPoint.g,a.nom.g)}else{this.doc.svg.appendChild(this.nomPoint.g)}a.nom=this.nomPoint}this.nomPoint.g.setAttribute("visibility","visible");if(!b){this.doc.actionSuivante(b)}};iep.actionNommerPoint.prototype.callBack=function(a){a.setReady();a.doc.waitForReadyState()};iep.actionNommerPoint.prototype.actionVisible=function(){return this.doc.getObjectVisibility(this.nomPoint.point,this.indice-1)};iep.actionPause=function(b,a){iep.actionAncetre.call(this,b,a)};iep.actionPause.prototype=new iep.actionAncetre();iep.actionPause.prototype.execute=function(a){if(!a){this.doc.activeIconeContinuer();this.doc.animationEnCours=false}};iep.actionPause.prototype.actionVisible=function(){return false};iep.actionModifierLongueur=function(d,b,c,a){iep.actionAncetre.call(this,d,a);this.instrument=b;this.longueur=c};iep.actionModifierLongueur.prototype=new iep.actionAncetre();iep.actionModifierLongueur.prototype.execute=function(b){if(this.instrument===this.doc.regle){this.instrument.longueur=this.longueur;var a=this.instrument.g;this.instrument.creeg();this.doc.svg.replaceChild(this.instrument.g,a);this.instrument.translate(this.instrument.x,this.instrument.y)}if(!b){this.doc.actionSuivante(b)}};iep.actionModifierLongueur.prototype.actionVisible=function(){return this.doc.getInstrumentVisibility(this.instrument,this.indice-1)};